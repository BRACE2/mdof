%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}

\usepackage{nbsphinx}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{mdof}
\date{Nov 13, 2023}
\release{0.0.7}
\author{Chrystal Chern}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxstepscope


\chapter{Reference}
\label{\detokenize{library/index:reference}}\label{\detokenize{library/index::doc}}

\section{modules}
\label{\detokenize{library/index:modules}}
\sphinxstepscope


\subsection{mdof.markov module}
\label{\detokenize{library/mdof.markov:module-mdof.markov}}\label{\detokenize{library/mdof.markov:mdof-markov-module}}\label{\detokenize{library/mdof.markov::doc}}\index{module@\spxentry{module}!mdof.markov@\spxentry{mdof.markov}}\index{mdof.markov@\spxentry{mdof.markov}!module@\spxentry{module}}\index{okid() (in module mdof.markov)@\spxentry{okid()}\spxextra{in module mdof.markov}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.markov:mdof.markov.okid}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.markov.}}\sphinxbfcode{\sphinxupquote{okid}}}{\sphinxparam{\DUrole{n,n}{inputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{outputs}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Identify Markov parameters, or discrete impulse response data, for a given set of input and output data.
Observer Kalman Identification Algorithm (OKID) (Juang, Phan, Horta, Longman, 1993).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} input time history. dimensions: \((q,nt)\), where
\(q\) = number of inputs, and \(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} output response history.
dimensions: \((p,nt)\), where \(p\) = number of outputs, and
\(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{m}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of Markov parameters to compute. default: \(min(300, nt)\)

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
the Markov parameters, with dimensions \((p,q,m+1)\)

\sphinxlineitem{Return type}
\sphinxAtStartPar
array

\end{description}\end{quote}

\end{fulllineitems}


\sphinxstepscope


\subsection{mdof.realize module}
\label{\detokenize{library/mdof.realize:module-mdof.realize}}\label{\detokenize{library/mdof.realize:mdof-realize-module}}\label{\detokenize{library/mdof.realize::doc}}\index{module@\spxentry{module}!mdof.realize@\spxentry{mdof.realize}}\index{mdof.realize@\spxentry{mdof.realize}!module@\spxentry{module}}\index{era() (in module mdof.realize)@\spxentry{era()}\spxextra{in module mdof.realize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.realize:mdof.realize.era}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.realize.}}\sphinxbfcode{\sphinxupquote{era}}}{\sphinxparam{\DUrole{n,n}{Y}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
System realization from Markov parameters (discrete impulse response data).
Eigensystem Realization Algorithm (ERA) (Ho and Kalman 1966, Juang and Pappa 1985).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} Markov parameters. dimensions: \((p,q,nt)\), where \(p\) = number of outputs,
\(q\) = number of inputs, and \(nt\) = number of Markov parameters.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{horizon}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of block rows in Hankel matrix = order of observability matrix.
default: \(min(150, (nt-1)/2)\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nc}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of block columns in Hankel matrix = order of controllability matrix.
default: \(min(150, max(nt-1-\) \sphinxcode{\sphinxupquote{horizon}}\(, (nt-1)/2))\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{order}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} model order. default: \(min(20,\) \sphinxcode{\sphinxupquote{horizon}}\(/2)\)

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
realization in the form of state space coefficients \sphinxcode{\sphinxupquote{(A,B,C,D)}}

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays

\end{description}\end{quote}

\end{fulllineitems}

\index{era\_dc() (in module mdof.realize)@\spxentry{era\_dc()}\spxextra{in module mdof.realize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.realize:mdof.realize.era_dc}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.realize.}}\sphinxbfcode{\sphinxupquote{era\_dc}}}{\sphinxparam{\DUrole{n,n}{Y}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
System realization from Markov parameters (discrete impulse response data).
Eigensystem Realization Algorithm with Data Correlations (ERA/DC) (Juang, Cooper, and Wright, 1988).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} Markov parameters. dimensions: \((p,q,nt)\), where \(p\) = number of outputs,
\(q\) = number of inputs, and \(nt\) = number of Markov parameters.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{horizon}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of block rows in Hankel matrix = order of observability matrix.
default: \(min(150, (nt-1)/2)\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nc}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of block columns in Hankel matrix = order of controllability matrix.
default: \(min(150, max(nt-1-\) \sphinxcode{\sphinxupquote{horizon}}\(, (nt-1)/2))\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{order}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} model order. default: \(min(20,\) \sphinxcode{\sphinxupquote{horizon}}\(/2)\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} \((\alpha)\) number of block rows in Hankel of correlation matrix. default: 0

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} \((\beta)\) number of block columns in Hankel of correlation matrix. default: 0

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{l}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} initial lag for data correlations. default: 0

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{g}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} lags (gap) between correlation matrices. default: 1

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
realization in the form of state space coefficients \sphinxcode{\sphinxupquote{(A,B,C,D)}}

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays

\end{description}\end{quote}

\end{fulllineitems}

\index{srim() (in module mdof.realize)@\spxentry{srim()}\spxextra{in module mdof.realize}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.realize:mdof.realize.srim}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.realize.}}\sphinxbfcode{\sphinxupquote{srim}}}{\sphinxparam{\DUrole{n,n}{inputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{outputs}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
System realization from input and output data, with output error minimization method.
System Realization Using Information Matrix (SRIM) (Juang, 1997).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} input time history. dimensions: \((q,nt)\), where
\(q\) = number of inputs, and \(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} output response history.
dimensions: \((p,nt)\), where \(p\) = number of outputs, and
\(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{horizon}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of steps used for identification (prediction horizon).
default: \(min(300, nt)\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{order}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} model order. default: \(min(20,\) \sphinxcode{\sphinxupquote{horizon}}\(/2)\)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{full}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} if True, full SVD. default: True

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{find}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} “ABCD” or “AC”. default: “ABCD”

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threads}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of threads used during the output error minimization method.
default: 6

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{chunk}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} chunk size in output error minimization method. default: 200

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
realization in the form of state space coefficients \sphinxcode{\sphinxupquote{(A,B,C,D)}}

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays

\end{description}\end{quote}

\end{fulllineitems}


\sphinxstepscope


\subsection{mdof.modal module}
\label{\detokenize{library/mdof.modal:module-mdof.modal}}\label{\detokenize{library/mdof.modal:mdof-modal-module}}\label{\detokenize{library/mdof.modal::doc}}\index{module@\spxentry{module}!mdof.modal@\spxentry{mdof.modal}}\index{mdof.modal@\spxentry{mdof.modal}!module@\spxentry{module}}
\sphinxAtStartPar
This module implements functions that extract modal information
from a state space realization.
\index{system\_modes() (in module mdof.modal)@\spxentry{system\_modes()}\spxextra{in module mdof.modal}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.modal:mdof.modal.system_modes}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.modal.}}\sphinxbfcode{\sphinxupquote{system\_modes}}}{\sphinxparam{\DUrole{n,n}{realization}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{dt}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Modal identification from a state space system realization.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{realization}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}) \textendash{} realization in the form of state space coefficients \sphinxcode{\sphinxupquote{(A,B,C,D)}}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dt}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} timestep.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{decimation}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} decimation factor. default: 1

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Observability}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Observability matrix; can be reused from {\hyperref[\detokenize{library/mdof.realize:mdof.realize.srim}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{mdof.realize.srim()}}}}}.
default: None

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
system modes, including natural frequencies, damping ratios, mode shapes,
condition numbers, and modal validation metrics EMAC and MPC.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dictionary

\end{description}\end{quote}

\end{fulllineitems}

\index{spectrum\_modes() (in module mdof.modal)@\spxentry{spectrum\_modes()}\spxextra{in module mdof.modal}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.modal:mdof.modal.spectrum_modes}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.modal.}}\sphinxbfcode{\sphinxupquote{spectrum\_modes}}}{\sphinxparam{\DUrole{n,n}{periods}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{amplitudes}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Modal identification from a transfer function.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{periods}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} transfer function periods

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{amplitudes}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} transfer function amplitudes

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
(fundamental\_periods, fundamental\_amplitudes)

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple

\end{description}\end{quote}

\end{fulllineitems}


\sphinxstepscope


\subsection{mdof.transform module}
\label{\detokenize{library/mdof.transform:module-mdof.transform}}\label{\detokenize{library/mdof.transform:mdof-transform-module}}\label{\detokenize{library/mdof.transform::doc}}\index{module@\spxentry{module}!mdof.transform@\spxentry{mdof.transform}}\index{mdof.transform@\spxentry{mdof.transform}!module@\spxentry{module}}\index{response\_transfer() (in module mdof.transform)@\spxentry{response\_transfer()}\spxextra{in module mdof.transform}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.transform:mdof.transform.response_transfer}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.transform.}}\sphinxbfcode{\sphinxupquote{response\_transfer}}}{\sphinxparam{\DUrole{n,n}{inputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{outputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{step}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Response spectrum transfer function from input and output data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} input time history. dimensions: \((q,nt)\), where
\(q\) = number of inputs, and \(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} output response history.
dimensions: \((p,nt)\), where \(p\) = number of outputs, and
\(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{step}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} timestep.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pseudo}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} if True, uses pseudo accelerations. default: False

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{decimation}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} decimation factor. default: 1

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
(periods, amplitudes)

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays

\end{description}\end{quote}

\end{fulllineitems}

\index{fourier\_transfer() (in module mdof.transform)@\spxentry{fourier\_transfer()}\spxextra{in module mdof.transform}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.transform:mdof.transform.fourier_transfer}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.transform.}}\sphinxbfcode{\sphinxupquote{fourier\_transfer}}}{\sphinxparam{\DUrole{n,n}{inputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{outputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{step}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Fourier spectrum transfer function from input and output data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} input time history. dimensions: \((q,nt)\), where
\(q\) = number of inputs, and \(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} output response history.
dimensions: \((p,nt)\), where \(p\) = number of outputs, and
\(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{step}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} timestep.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{decimation}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} decimation factor. default: 1

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
(periods, amplitudes)

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays

\end{description}\end{quote}

\end{fulllineitems}

\index{fourier\_spectrum() (in module mdof.transform)@\spxentry{fourier\_spectrum()}\spxextra{in module mdof.transform}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/mdof.transform:mdof.transform.fourier_spectrum}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.transform.}}\sphinxbfcode{\sphinxupquote{fourier\_spectrum}}}{\sphinxparam{\DUrole{n,n}{series}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{step}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{period\_band}\DUrole{o,o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Fourier amplitude spectrum from a signal.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{series}} (\sphinxstyleliteralemphasis{\sphinxupquote{1D array}}) \textendash{} time series.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{step}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} timestep.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{period\_band}} \textendash{} minimum and maximum period of interest, in seconds.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
(frequencies, amplitudes)

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays.

\end{description}\end{quote}

\end{fulllineitems}



\section{top\sphinxhyphen{}level functions}
\label{\detokenize{library/index:module-mdof}}\label{\detokenize{library/index:top-level-functions}}\index{module@\spxentry{module}!mdof@\spxentry{mdof}}\index{mdof@\spxentry{mdof}!module@\spxentry{module}}\index{impulse() (in module mdof)@\spxentry{impulse()}\spxextra{in module mdof}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/index:mdof.impulse}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.}}\sphinxbfcode{\sphinxupquote{impulse}}}{\sphinxparam{\DUrole{n,n}{system}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{t}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{kwds}}}{}
\pysigstopsignatures
\end{fulllineitems}

\index{sysid() (in module mdof)@\spxentry{sysid()}\spxextra{in module mdof}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/index:mdof.sysid}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.}}\sphinxbfcode{\sphinxupquote{sysid}}}{\sphinxparam{\DUrole{n,n}{inputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{outputs}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
State space system realization from input and output data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} input time history. dimensions: \((q,nt)\), where
\(q\) = number of inputs, and \(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} output response history.
dimensions: \((p,nt)\), where \(p\) = number of outputs, and
\(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{method}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} system identification method. default is “srim”, other options are “okid\sphinxhyphen{}era” and “okid\sphinxhyphen{}era\sphinxhyphen{}dc”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{decimation}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} decimation factor. default: 8

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
system realization in the form of state space coefficients \sphinxcode{\sphinxupquote{(A,B,C,D)}}

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of arrays

\end{description}\end{quote}

\end{fulllineitems}

\index{eigid() (in module mdof)@\spxentry{eigid()}\spxextra{in module mdof}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{library/index:mdof.eigid}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{mdof.}}\sphinxbfcode{\sphinxupquote{eigid}}}{\sphinxparam{\DUrole{n,n}{inputs}}\sphinxparamcomma \sphinxparam{\DUrole{n,n}{outputs}}\sphinxparamcomma \sphinxparam{\DUrole{o,o}{**}\DUrole{n,n}{options}}}{}
\pysigstopsignatures
\sphinxAtStartPar
System eigenspace identification from input and output data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} input time history. dimensions: \((q,nt)\), where
\(q\) = number of inputs, and \(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outputs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} output response history.
dimensions: \((p,nt)\), where \(p\) = number of outputs, and
\(nt\) = number of timesteps

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dt}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} timestep.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{decimation}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} decimation factor. default: 1

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxtitleref{(eigenvalues, eigenvectors)}

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple of 1D array, ND array

\end{description}\end{quote}

\end{fulllineitems}


\sphinxstepscope


\chapter{Theory}
\label{\detokenize{theory/index:theory}}\label{\detokenize{theory/index::doc}}
\sphinxstepscope


\section{State Space Model of Structural Dynamics}
\label{\detokenize{theory/statespace:state-space-model-of-structural-dynamics}}\label{\detokenize{theory/statespace::doc}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=3093\sphinxpxdimen,height=1172\sphinxpxdimen]{{si_msmdof}.png}
\caption{MDOF Structure}\label{\detokenize{theory/statespace:id1}}\end{figure}

\sphinxAtStartPar
When an multiple degree\sphinxhyphen{}of\sphinxhyphen{}freedom (MDOF) system is subject to multiple
support excitation, such as in the figure above, the displacement vector
is extended to include the support DOF. An {\hyperref[\detokenize{theory/statespace:equation-of-motion}]{\sphinxcrossref{\DUrole{std,std-ref}{equation of
motion}}}} is derived as follows.

\sphinxAtStartPar
Begin by forming a partitioned equation of dynamic equilibrium for all
the DOF:


\subsection{Partitioned Equation of Dynamic Equilibrium}
\label{\detokenize{theory/statespace:partitioned-equation-of-dynamic-equilibrium}}\begin{equation*}
\begin{split}\begin{bmatrix} \mathbf{m} & \mathbf{m}_{g} \\ \mathbf{m}^T_{g} & \mathbf{m}_{gg} \end{bmatrix}
\begin{bmatrix} \mathbf{\ddot{u}}^{t}_{f} \\ \mathbf{\ddot{u}}_{g} \end{bmatrix}
+
\begin{bmatrix} \mathbf{c} & \mathbf{c}_{g} \\ \mathbf{c}^T_{g} & \mathbf{c}_{gg} \end{bmatrix}
\begin{bmatrix} \mathbf{\dot{u}}^{t}_{f} \\ \mathbf{\dot{u}}_{g} \end{bmatrix}
+
\begin{bmatrix} \mathbf{k} & \mathbf{k}_{g} \\ \mathbf{k}^T_{g} & \mathbf{k}_{gg} \end{bmatrix}
\begin{bmatrix} \mathbf{u}^{t}_{f} \\ \mathbf{u}_{g} \end{bmatrix}
=
\begin{bmatrix} \mathbf{0} \\ \mathbf{p}_{g} \end{bmatrix}\end{split}
\end{equation*}
\sphinxAtStartPar
where the subscript \(g\) indicates support DOF, the subscript
\(f\) indicates structural DOF, and the superscript \(t\)
indicates the total of quasi\sphinxhyphen{}static (\(\mathbf{u}^{s}_{f}\), due to
static application of support displacements) and dynamic
(\(\mathbf{u}_{f}\), evaluated by dynamic analysis) structural
displacements.

\sphinxAtStartPar
Taking the first half of the partitioned equilibrium, separating the
structural displacements
(\(\mathbf{u}^{t}_{f}=\mathbf{u}^{s}_{f}+\mathbf{u}_{f}\)), and
moving all \(\mathbf{u}_{g}\) and \(\mathbf{u}^{s}_{f}\) terms
to the right side,
\begin{equation*}
\begin{split}\mathbf{m}\mathbf{\ddot{u}}_{f} + \mathbf{c}\mathbf{\dot{u}}_{f} + \mathbf{k}\mathbf{u}_{f}
= -(\mathbf{m}\mathbf{\ddot{u}}^{s}_{f}+\mathbf{m}_{g}\mathbf{\ddot{u}}_{g})
-(\mathbf{c}\mathbf{\dot{u}}^{s}_{f}+\mathbf{c}_{g}\mathbf{\dot{u}}_{g})
-(\mathbf{k}\mathbf{u}^{s}_{f}+\mathbf{k}_{g}\mathbf{u}_{g})\end{split}
\end{equation*}
\sphinxAtStartPar
The term
\((\mathbf{k}\mathbf{u}^{s}_{f}+\mathbf{k}_{g}\mathbf{u}_{g})=\mathbf{0}\)
due to static equilibrium, allowing the term to be dropped and giving
\(\mathbf{u}^{s}_{f} = \mathbf{-k}^{-1}\mathbf{k}_{g}\mathbf{u}_{g} = \mathbf{\iota u}_{g}\);
the term
\((\mathbf{c}\mathbf{\dot{u}}^{s}_{f}+\mathbf{c}_{g}\mathbf{\dot{u}}_{g})\)
is dropped because it is usually small relative to the inertia term; and
the term \(\mathbf{m}_{g}\mathbf{\ddot{u}}_{g}\) is dropped because
mass is usually neglected at supports.

\sphinxAtStartPar
The equilibrium equation thus simplifies.


\subsection{Equation of Motion}
\label{\detokenize{theory/statespace:equation-of-motion}}\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{M\ddot{u}}_{f}(t) + \mathbf{Z\dot{u}}_{f}(t) + \mathbf{Ku}_{f}(t) &= -\mathbf{M\iota}\mathbf{\ddot{u}}_{g}(t) \\
    \mathbf{m}\mathbf{\ddot{u}}_{f} + \mathbf{c}\mathbf{\dot{u}}_{f} + \mathbf{k}\mathbf{u}_{f}
    &= -\mathbf{m}\mathbf{\iota}\mathbf{\ddot{u}}_{g}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Hence, the following equation presents the continuous linear
time\sphinxhyphen{}invariant (LTI) state\sphinxhyphen{}space representation of a structural system.


\subsection{Continuous LTI State\sphinxhyphen{}Space Representation}
\label{\detokenize{theory/statespace:continuous-lti-state-space-representation}}\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{\dot{x}} &= \mathbf{A}_{c}\mathbf{x} + \mathbf{B}_{c}\mathbf{u} \\
    \begin{bmatrix} \mathbf{\dot{u}}_{f}(t) \\ \mathbf{\ddot{u}}_{f}(t) \end{bmatrix}
    &=
    \begin{bmatrix} \mathbf{0} & \mathbf{I} \\ -\mathbf{M}^{-1}\mathbf{K} & -\mathbf{M}^{-1}\mathbf{Z} \end{bmatrix}
    \begin{bmatrix} \mathbf{u}_{f}(t) \\ \mathbf{\dot{u}}_{f}(t) \end{bmatrix}
    +
    \begin{bmatrix} \mathbf{0} \\ -\mathbf{\iota} \end{bmatrix}
    \mathbf{\ddot{u}}_{g}(t) \\ \\
    \mathbf{y} &= \mathbf{Cx} + \mathbf{Du} \\
    \mathbf{\ddot{u}}_{f}(t) &=
    \begin{bmatrix} -\mathbf{M}^{-1}\mathbf{K} & -\mathbf{M}^{-1}\mathbf{Z} \end{bmatrix}
    \begin{bmatrix} \mathbf{u}_{f}(t) \\ \mathbf{\dot{u}}_{f}(t) \end{bmatrix}
    +
    \begin{bmatrix} -\mathbf{\iota} \end{bmatrix}
    \mathbf{\ddot{u}}_{g}(t)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
In order to move from the continuous to the discrete case, the
coefficients \(\mathbf{A}_{c}\) and \(\mathbf{B}_{c}\) are
transformed by solving the first\sphinxhyphen{}order differential equation with the
signal’s value held constant between time steps (“zero\sphinxhyphen{}order hold
method”). The coefficients \(\mathbf{C}\) and \(\mathbf{D}\) are
unchanged. The results are shown in the following equation.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=409\sphinxpxdimen,height=268\sphinxpxdimen]{{si_discretize}.png}
\caption{Signal Discretization}\label{\detokenize{theory/statespace:id2}}\end{figure}


\subsection{Discrete LTI State\sphinxhyphen{}Space Representation}
\label{\detokenize{theory/statespace:discrete-lti-state-space-representation}}\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{x}_{k+1} &= \mathbf{Ax}_{k} + \mathbf{Bu}_{k} \\
    \mathbf{y}_{k} &= \mathbf{Cx}_{k} + \mathbf{Du}_{k} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{x}_{k} = \mathbf{x}(k\Delta t), \hspace{1cm} \mathbf{u}_{k} = \mathbf{u}(k\Delta t), \hspace{1cm} \mathbf{y}_{k} = \mathbf{y}(k\Delta t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{A} = e^{\mathbf{A}_{c}\Delta t}, \hspace{1cm} \mathbf{B} = \int_{0}^{\Delta t}{e^{\mathbf{A}_{c}\tau}}\mathbf{B}_{c}d\tau\end{split}
\end{equation*}
\sphinxAtStartPar
where:
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{A} & \text{: discrete state transition matrix} \\
    \mathbf{B} & \text{: discrete input influence matrix} \\
    \mathbf{C} & \text{: output influence matrix} \\
    \mathbf{D} & \text{: direct transmission or feed-through matrix}
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\section{Eigensystem Realization Algorithm (ERA)}
\label{\detokenize{theory/era:eigensystem-realization-algorithm-era}}\label{\detokenize{theory/era::doc}}
\sphinxAtStartPar
As shown in the previous section, a structural system’s dynamic behavior
can be represented by the four coefficients
(\(\mathbf{A},\mathbf{B},\mathbf{C},\mathbf{D}\)) of its discrete
LTI state\sphinxhyphen{}space representation. The \sphinxhref{https://doi.org/10.1524/auto.1966.14.112.545}{Ho\sphinxhyphen{}Kalman
Algorithm}, or
\sphinxhref{https://doi.org/10.2514/3.20031}{Eigensystem Realization Algorithm},
produces a \sphinxstyleemphasis{reduced order model} for these four coefficients,
(\(\mathbf{\tilde{A}},\mathbf{\tilde{B}},\mathbf{\tilde{C}},\mathbf{\tilde{D}}\)),
based on an impulse input and its corresponding response output. Then,
modal properties can be extracted from \(\mathbf{\tilde{A}}\) and
\(\mathbf{\tilde{C}}\).

\sphinxAtStartPar
With the discrete LTI model, a unit impulse input with zero initial
conditions produces an output of constants
(\(\mathbf{D,CB,CAB,...,CA}^{k-1}\mathbf{B}\)). These constants are
called \sphinxstyleemphasis{Markov parameters} because they must be unique for a given
system \textendash{} there is only one possible output for a unit impulse input.
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{x}_{k+1} &= \mathbf{Ax}_{k} + \mathbf{Bu}_{k} \\
    \mathbf{y}_{k} &= \mathbf{Cx}_{k} + \mathbf{Du}_{k} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{u}_{0},\mathbf{u}_{1},\mathbf{u}_{2},...,\mathbf{u}_{k} &= \mathbf{I,0,0,...,0} \\
    \mathbf{x}_{0},\mathbf{x}_{1},\mathbf{x}_{2},...,\mathbf{x}_{k} &= \mathbf{0,B,AB,...,A}^{k-1}\mathbf{B} \\
    \mathbf{y}_{0},\mathbf{y}_{1},\mathbf{y}_{2},...,\mathbf{y}_{k} &= \mathbf{D,CB,CAB,...,CA}^{k-1}\mathbf{B} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Knowing that the impulse response output data directly give the Markov
parameters, the data can then be stacked into the generalized blockwise
Hankel matrix \(\mathbf{H}\):
\begin{equation*}
\begin{split}\mathbf{H}
=
\begin{bmatrix}
    \mathbf{y}_{1}     & \mathbf{y}_{2}        & \cdots   & \mathbf{y}_{m_{c}}          \\
    \mathbf{y}_{2}     & \mathbf{y}_{3}        & \cdots   & \mathbf{y}_{m_{c}+1}        \\
    \vdots             & \vdots                & \ddots   & \vdots                      \\
    \mathbf{y}_{m_{o}} & \mathbf{y}_{m_{o}+1}  & \cdots   & \mathbf{y}_{m_{o}+m_{c}-1}  \\
\end{bmatrix}
=
\begin{bmatrix}
    \mathbf{CB}                     & \mathbf{CAB}                  & \cdots  & \mathbf{CA}^{m_{c}-1}\mathbf{B}       \\
    \mathbf{CAB}                    & \mathbf{CA}^{2}\mathbf{B}     & \cdots  & \mathbf{CA}^{m_{c}}\mathbf{B}         \\
    \vdots                          & \vdots                        & \ddots  & \vdots                                \\
    \mathbf{CA}^{m_{o}-1}\mathbf{B} & \mathbf{CA}^{m_{o}}\mathbf{B} & \cdots  & \mathbf{CA}^{m_{c}+m_{o}-2}\mathbf{B} \\
\end{bmatrix}
=
\mathbf{\mathcal{OC}}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(\mathbf{\mathcal{O}}\) and \(\mathbf{\mathcal{C}}\) are
the observability and controllability matrices of the system:
\begin{equation*}
\begin{split}\mathbf{\mathcal{O}} = \begin{bmatrix}
    \mathbf{C} \\ \mathbf{CA} \\ \mathbf{CA}^{2} \\ \vdots \\ \mathbf{CA}^{m_{o}-1}
\end{bmatrix}, \hspace{1cm}
\mathbf{\mathcal{C}} = \begin{bmatrix} \mathbf{B} & \mathbf{AB} & \mathbf{A}^{2}\mathbf{B} & \cdots & \mathbf{A}^{m_{c}-1}\mathbf{B}  \end{bmatrix}\end{split}
\end{equation*}
\sphinxAtStartPar
The shifted Hankel matrix, \(\mathbf{H'}\) (one time step ahead of
\(\mathbf{H}\)), is shown below:
\begin{equation*}
\begin{split}\mathbf{H'}
=
\begin{bmatrix}
    \mathbf{y}_{2}       & \mathbf{y}_{3}        & \cdots   & \mathbf{y}_{m_{c}+1}        \\
    \mathbf{y}_{3}       & \mathbf{y}_{4}        & \cdots   & \mathbf{y}_{m_{c}+2}        \\
    \vdots               & \vdots                & \ddots   & \vdots                      \\
    \mathbf{y}_{m_{o}+1} & \mathbf{y}_{m_{o}+2}  & \cdots   & \mathbf{y}_{m_{o}+m_{c}}    \\
\end{bmatrix}
=
\begin{bmatrix}
    \mathbf{CAB}                    & \mathbf{CA}^{2}\mathbf{B}     & \cdots  & \mathbf{CA}^{m_{c}}\mathbf{B}          \\
    \mathbf{CA}^{2}\mathbf{B}       & \mathbf{CA}^{3}\mathbf{B}     & \cdots  & \mathbf{CA}^{m_{c}+1}\mathbf{B}        \\
    \vdots                          & \vdots                        & \ddots  & \vdots                                 \\
    \mathbf{CA}^{m_{o}}\mathbf{B}   & \mathbf{CA}^{m_{o}+1}\mathbf{B} & \cdots  & \mathbf{CA}^{m_{c}+m_{o}-1}\mathbf{B}\\
\end{bmatrix}
=
\mathbf{\mathcal{O}A\mathcal{C}}\end{split}
\end{equation*}
\sphinxAtStartPar
By taking the dominant terms of the singular value decomposition
of \(\mathbf{H}\), and transforming the relationship between
\(\mathbf{H} = \mathbf{\mathcal{OC}}\) and
\(\mathbf{H'} = \mathbf{\mathcal{O}A\mathcal{C}}\), a reduced\sphinxhyphen{}order
model is constructed as follows:
\begin{equation*}
\begin{split}\mathbf{H} = \mathbf{U}\Sigma\mathbf{V}^{H} =
\begin{bmatrix} \mathbf{\tilde{U}} & \mathbf{U}_{t} \end{bmatrix}
\begin{bmatrix} \tilde{\Sigma} & \mathbf{0} \\ \mathbf{0} & \Sigma_{t} \end{bmatrix}
\begin{bmatrix} \mathbf{\tilde{V}}^{H} \\ \mathbf{V}_{t}^{H} \end{bmatrix}
\approx \mathbf{\tilde{U}}\tilde{\Sigma}\mathbf{\tilde{V}}^{H}\end{split}
\end{equation*}
\sphinxAtStartPar
where the superscript \(H\) denotes conjugate transpose and the
subscript \(t\) indicates elements to be truncated such that only
the first \(r\) dominant singular values in \(\tilde{\Sigma}\)
are retained,
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{\tilde{A}} &= \tilde{\Sigma}^{-1/2}\mathbf{\tilde{U}}^{H}\mathbf{H'\tilde{V}}\tilde{\Sigma}^{-1/2} \\
    \mathbf{\tilde{B}} &= \tilde{\Sigma}^{1/2}\mathbf{\tilde{V}}^{H}
                        \begin{bmatrix} \mathbf{I}_{q} \\ \mathbf{0} \end{bmatrix} \\
    \mathbf{\tilde{C}} &= \begin{bmatrix} \mathbf{I}_{p} & \mathbf{0} \end{bmatrix} \mathbf{\tilde{U}}\tilde{\Sigma}^{1/2} \\
    \mathbf{\tilde{D}} &= \mathbf{y}_{0}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(p\) indicates the number of outputs and \(q\) the number
of inputs, and
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{\tilde{x}}_{k+1} &= \mathbf{\tilde{A}\tilde{x}}_{k} + \mathbf{\tilde{B}u}_{k} \\
    \mathbf{y}_{k} &= \mathbf{\tilde{C}\tilde{x}}_{k} + \mathbf{\tilde{D}u}_{k}. \\
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\section{Observer Kalman Filter Identification (OKID)}
\label{\detokenize{theory/okid:observer-kalman-filter-identification-okid}}\label{\detokenize{theory/okid::doc}}
\sphinxAtStartPar
Structural dynamics are noisy, hard to measure, and lightly damped, and
ERA is intended only to characterize impulse responses rather than time
histories. However, available data from ambient or small excitations
during structure service can be de\sphinxhyphen{}noised and used to estimate impulse
response data. Then, ERA can be used to obtain a reduced order model
even if the available data are not a clean impulse response. This
process is called \sphinxhref{https://doi.org/10.2514/3.21006}{Observer Kalman
Identification}, or OKID\sphinxhyphen{}ERA when
combined with ERA.

\sphinxAtStartPar
When noise is incorporated into the discrete LTI state\sphinxhyphen{}space
representation of a structural system, it becomes a \sphinxstyleemphasis{linear Gaussian
model} of a \sphinxstyleemphasis{hidden Markov process}.

\sphinxAtStartPar
Because the data are assumed to follow a linear Gaussian model, Kalman
filtering can estimate an impulse response that is most consistent with
the input\sphinxhyphen{}output data. The estimated model after filtering is the same
as that of ERA:
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{x}_{k+1} &= \mathbf{Ax}_{k} + \mathbf{Bu}_{k} \\
    \mathbf{y}_{k} &= \mathbf{Cx}_{k} + \mathbf{Du}_{k} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Since the input is no longer an impulse, the state\sphinxhyphen{}space evolution
includes more terms than ERA.
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{u}_{0},\mathbf{u}_{1},\mathbf{u}_{2},...,\mathbf{u}_{k} :=& \text{given input} \\
    \mathbf{x}_{0},\mathbf{x}_{1},\mathbf{x}_{2},...,\mathbf{x}_{k} =&  \mathbf{0},(\mathbf{Bu}_{0}),(\mathbf{ABu}_{0}+\mathbf{Bu}_{1}),...,(\mathbf{A}^{k-1}\mathbf{Bu}_{0}+\mathbf{A}^{k-2}\mathbf{Bu}_{1}+...+\mathbf{Bu}_{k-1}) \\
    \mathbf{y}_{0},\mathbf{y}_{1},\mathbf{y}_{2},...,\mathbf{y}_{k} =&  \mathbf{Du}_0,(\mathbf{CBu}_{0}+\mathbf{Du}_{1}),(\mathbf{CABu}_{0}+\mathbf{CBu}_{1}+\mathbf{Du}_{2}),..., \\
    & (\mathbf{CA}^{k-1}\mathbf{Bu}_{0}+\mathbf{CA}^{k-2}\mathbf{Bu}_{1}+...+\mathbf{Du}_{k}).
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The output data can be expressed in terms of the Markov parameters and
an upper triangular \sphinxstyleemphasis{data matrix} \(\mathscr{B}\) built from the
input data; however, inverting \(\mathscr{B}\) is often
computationally expensive or ill\sphinxhyphen{}conditioned.
\begin{equation*}
\begin{split}\underbrace{\begin{bmatrix} \mathbf{y}_{0} & \mathbf{y}_{1} & \mathbf{y}_{2} & \cdots & \mathbf{y}_{m} \end{bmatrix}}_{\mathbf{S}}
=
\underbrace{\begin{bmatrix} \mathbf{y}_{0} & \mathbf{y}_{1} & \mathbf{y}_{2} & \cdots & \mathbf{y}_{m} \end{bmatrix}_{\delta}}_{\mathbf{S}_{\delta}}
\underbrace{\begin{bmatrix}
    \mathbf{u}_{0} & \mathbf{u}_{1} & \cdots & \mathbf{u}_{m}   \\
    \mathbf{0}     & \mathbf{u}_{0} & \cdots & \mathbf{u}_{m-1} \\
    \vdots         & \vdots         & \ddots & \vdots           \\
    \mathbf{0}     & \mathbf{0}     & \cdots & \mathbf{u}_{0}   \\
\end{bmatrix}}_{\mathscr{B}}\end{split}
\end{equation*}
\sphinxAtStartPar
where the subscript \(\delta\) indicates that the response comes
from an impulse input.

\sphinxAtStartPar
The Kalman filter is applied by augmenting the system with the outputs
\(\mathbf{y}_{i}\) to form the \sphinxstyleemphasis{augmented data matrix}
\(\mathscr{V}\):
\begin{equation*}
\begin{split}\mathscr{V}
=
\begin{bmatrix}
    \mathbf{u}_{0} & \mathbf{u}_{1} & \cdots & \mathbf{u}_{l}   & \cdots & \mathbf{u}_{m}   \\
    \mathbf{0}     & \mathbf{v}_{0} & \cdots & \mathbf{v}_{l-1} & \cdots & \mathbf{v}_{m-1} \\
    \vdots         & \vdots         & \ddots & \vdots           & \ddots & \vdots           \\
    \mathbf{0}     & \mathbf{0}     & \cdots & \mathbf{v}_{0}   & \cdots & \mathbf{v}_{m-l} \\
\end{bmatrix}, \hspace{1cm}
\mathbf{v}_{i} = \begin{bmatrix} \mathbf{u}_{i} \\ \mathbf{y}_{i} \end{bmatrix}.\end{split}
\end{equation*}
\sphinxAtStartPar
Then, the Markov parameters (i.e., the impulse response) can be
estimated as a function of the input and output data as follows:
\begin{equation*}
\begin{split}\hat{\mathbf{S}}_\delta = \mathbf{S}\mathscr{V}^{\dagger}\end{split}
\end{equation*}
\sphinxAtStartPar
where the superscript \(\dagger\) indicates pseudo\sphinxhyphen{}inverse,

\sphinxAtStartPar
Extract the estimated, or \sphinxstyleemphasis{observer}, Markov parameters from the block
columns of \(\hat{\mathbf{S}}_\delta\):
\begin{equation*}
\begin{split}\begin{aligned}
        \hat{\mathbf{S}}_{\delta 0} &\in \mathbb{R}^{p\times q} \\
        \hat{\mathbf{S}}_{\delta k} &=
        \begin{bmatrix} \hat{\mathbf{S}}_{\delta k}^{(1)} & \hat{\mathbf{S}}_{\delta k}^{(2)} \end{bmatrix} , \hspace{0.5cm} k\in[1,2,...] \\
    \hat{\mathbf{S}}_{\delta k}^{(1)} &\in\mathbb{R}^{p\times q}, \hspace{0.5cm}
    \hat{\mathbf{S}}_{\delta k}^{(2)}  \in\mathbb{R}^{p\times p}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Reconstruct the system Markov parameters:
\begin{equation*}
\begin{split}\mathbf{y}_{\delta 0} = \hat{\mathbf{S}}_{\delta 0} = \mathbf{D}, \hspace{0.5cm}
\mathbf{y}_{\delta k} = \hat{\mathbf{S}}_{\delta k}^{(1)}
+ \sum_{i=1}^{k}{\hat{\mathbf{S}}_{\delta k}^{(2)}}\mathbf{y}_{\delta (k-i)}.\end{split}
\end{equation*}
\sphinxstepscope


\section{System Realization by Information Matrix (SRIM)}
\label{\detokenize{theory/srim:system-realization-by-information-matrix-srim}}\label{\detokenize{theory/srim::doc}}
\sphinxAtStartPar
For discrete\sphinxhyphen{}time systems, the correlation between inputs, outputs, and
state yield information about the system’s state evolution and response.
In fact, the state equations can be estimated by manipulating
correlation matrices through the method, \sphinxhref{https://doi.org/10.2514/2.4068}{System Realization by
Information Matrix} (SRIM).


\subsection{Discrete\sphinxhyphen{}Time System Matrix Equation}
\label{\detokenize{theory/srim:discrete-time-system-matrix-equation}}
\sphinxAtStartPar
We begin with discrete\sphinxhyphen{}time state equations that correspond to the
structure’s dynamics (see \sphinxhref{https://brace2.github.io/mdof/theory/statespace.html\#discrete-lti-state-space-representation}{Discrete LTI State\sphinxhyphen{}Space
Representation}).
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{x}(k+1) &= \mathbf{Ax}(k) + \mathbf{Bu}(k) \\
\mathbf{y}(k) &= \mathbf{Cx}(k) + \mathbf{Du}(k)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
By noting the state evolution
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{x}(k+1) &= \mathbf{Ax}(k)+\mathbf{B}\mathbf{U}_{p}(k)\\
\mathbf{x}(k+2) &= \mathbf{A}^2\mathbf{X}(k) + \mathbf{AB}\mathbf{U}_{p}(k) + \mathbf{Bu}(k+1)\\
\mathbf{x}(k+3) &= \mathbf{A}^{3}\mathbf{X}(k) + \mathbf{A}^{2}\mathbf{Bu}(k) + \mathbf{ABu}(k+1) + \mathbf{Bu}(k+2),
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
we can generalize the response for the timepoint \(k+p-1\):
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{x}(k+p) &= \mathbf{A}^{p}\mathbf{x}(k) + \sum_{i=1}^{p}\mathbf{A}^{p-i}\mathbf{Bu}(k+i-1)
\\
\mathbf{x}(k+p-1) &= \mathbf{A}^{p-1}\mathbf{x}(k) + \sum_{i=1}^{p-1}\mathbf{A}^{p-i-1}\mathbf{Bu}(k+i-1)
\\
\mathbf{y}(k+p-1) &= \mathbf{CA}^{p-1}\mathbf{x}(k) + \sum_{i=1}^{p-1}\mathbf{CA}^{p-i-1}\mathbf{Bu}(k+i-1)+\mathbf{Du}(k+p-1)~.
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Then, we can vertically stack \(p\) successive time\sphinxhyphen{}points into a
column vector and express this vector as \(\mathbf{y}_{p}(k)\):
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{y}_{p}(k) &= \mathcal{O}_{p}\mathbf{x}(k) + \mathcal{T}_{p}\mathbf{u}_{p}(k) \\
\begin{bmatrix}
\mathbf{y}(k) \\
\mathbf{y}(k+1) \\
\vdots \\
\mathbf{y}(k+p-1)
\end{bmatrix}
=&
\begin{bmatrix}
\mathbf{C} \\
\mathbf{CA} \\
\mathbf{CA}^{2} \\
\vdots \\
\mathbf{CA}^{p-1}
\end{bmatrix}
\mathbf{x}(k)
~+ \\
&
\begin{bmatrix}
\mathbf{D} \\
\mathbf{CB} & \mathbf{D} \\
\mathbf{CAB} & \mathbf{CB} & \mathbf{D} \\
\vdots & \vdots & \vdots & \ddots \\
\mathbf{CA}^{p-2}\mathbf{B} & \mathbf{CA}^{p-3}\mathbf{B} & \mathbf{CA}^{p-4}\mathbf{B} & \cdots & \mathbf{D}
\end{bmatrix}
\begin{bmatrix}
\mathbf{u}(k) \\
\mathbf{u}(k+1) \\
\vdots \\
\mathbf{u}(k+p-1)
\end{bmatrix}~.
\end{aligned}\end{split}
\end{equation*}


\sphinxAtStartPar
Next, we horizontally stack \(N\) successive timepoints of these
column vectors in a matrix, to get the matrix equation
\begin{equation*}
\begin{split}\boxed{\mathbf{Y}_{p}(k) = \mathcal{O}_{p}\mathbf{X}(k) + \mathcal{T}_{p}\mathbf{U}_{p}(k)} ~,\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{Y}_{p}(k) &= \begin{bmatrix} \mathbf{y}_{p}(k) & \mathbf{y}_{p}(k+1) & \cdots & \mathbf{y}_{p}(k+N-1) \end{bmatrix} \\
&= \begin{bmatrix}
\mathbf{y}(k)     & \mathbf{y}(k+1) & \cdots & \mathbf{y}(k+N-1)\\
\mathbf{y}(k+1)   & \mathbf{y}(k+2) & \cdots & \mathbf{y}(k+N)  \\
\vdots            & \vdots          & \ddots & \vdots \\
\mathbf{y}(k+p-1) & \mathbf{y}(k+p) & \cdots & \mathbf{y}(k+N+p-2)
\end{bmatrix}
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{X}(k) = \begin{bmatrix} \mathbf{x}(k) & \mathbf{x}(k+1) & \cdots & \mathbf{x}(k+N-1) \end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{U}_{p}(k) &= \begin{bmatrix} \mathbf{u}_{p}(k) & \mathbf{u}_{p}(k+1) & \cdots & \mathbf{u}_{p}(k+N-1) \end{bmatrix} \\
&= \begin{bmatrix}
\mathbf{u}(k)     & \mathbf{u}(k+1) & \cdots & \mathbf{u}(k+N-1)\\
\mathbf{u}(k+1)   & \mathbf{u}(k+2) & \cdots & \mathbf{u}(k+N)  \\
\vdots            & \vdots          & \ddots & \vdots \\
\mathbf{u}(k+p-1) & \mathbf{u}(k+p) & \cdots & \mathbf{u}(k+N+p-2)
\end{bmatrix}~.
\end{aligned}\end{split}
\end{equation*}

\subsection{Observability Matrix from Information Matrix}
\label{\detokenize{theory/srim:observability-matrix-from-information-matrix}}
\sphinxAtStartPar
By post\sphinxhyphen{}multiplying the matrix equation by
\(\frac{1}{N}\mathbf{U}_{p}^{T}(k)\),
\(\frac{1}{N}\mathbf{Y}_{p}^{T}(k)\) or
\(\frac{1}{N}\mathbf{X}_{p}^{T}(k)\), we obtain relationships
between correlation matrices \(\mathbf{R}_{yy}\),
\(\mathbf{R}_{yu}\), \(\mathbf{R}_{uu}\), and
\(\mathbf{R}_{xx}\) (See
{\hyperref[\detokenize{theory/srim:appendix-manipulation-of-discrete-time-system-matrix-equation-into-correlation-matrix-relationships}]{\sphinxcrossref{\DUrole{std,std-ref}{Appendix}}}}).
\begin{equation*}
\begin{split}\mathbf{R}_{yy} - \mathbf{R}_{yu}\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T} = \mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T} ~,\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{R}_{yy} &= \frac{1}{N}\mathbf{Y}_{p}(k)\mathbf{Y}_{p}^{T}(k), \quad{}
\mathbf{R}_{yu} = \frac{1}{N}\mathbf{Y}_{p}(k)\mathbf{U}_{p}^{T}(k) \\
\mathbf{R}_{uu} &= \frac{1}{N}\mathbf{U}_{p}(k)\mathbf{U}_{p}^{T}(k) , \quad{}
\mathbf{R}_{xx} = \frac{1}{N}\mathbf{X}(k)\mathbf{X}^{T}(k) ~.
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The left side of the equation is found from input and output
measurements, and is called the \sphinxstyleemphasis{information matrix} of the data. Its
singular value decomposition is computed to yield the \sphinxstyleemphasis{observability
matrix} \(\mathcal{O}_{p}\).
\begin{equation*}
\begin{split}\mathbf{R}_{yy} - \mathbf{R}_{yu}\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T} = \mathbf{U} \Sigma \mathbf{U}^{T} = \mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T} ~.\end{split}
\end{equation*}

\subsection{State Equation Matrices from Observability Matrix}
\label{\detokenize{theory/srim:state-equation-matrices-from-observability-matrix}}
\sphinxAtStartPar
Now, the state equation matrices \(\mathbf{A}\) and
\(\mathbf{C}\) can be obtained from the observability matrix
\(\mathcal{O}_p\).
\begin{equation*}
\begin{split}\begin{aligned}
\mathcal{O}_{p}
=
\begin{bmatrix}
\mathbf{C} \\
\mathbf{CA} \\
\mathbf{CA}^{2} \\
\vdots \\
\mathbf{CA}^{p-1}
\end{bmatrix}
, \quad{}
\mathcal{O}_{p}(:-1)
=
\begin{bmatrix}
\mathbf{C} \\
\mathbf{CA} \\
\mathbf{CA}^{2} \\
\vdots \\
\mathbf{CA}^{p-2}
\end{bmatrix}
, \quad{}
\mathcal{O}_{p}(1:)
=
\begin{bmatrix}
\mathbf{CA} \\
\mathbf{CA}^{2} \\
\mathbf{CA}^{3} \\
\vdots \\
\mathbf{CA}^{p-1}
\end{bmatrix}
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{A} = \mathcal{O}_{p}(:-1)^{+}\mathcal{O}_{p}(1:)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{C} = \mathcal{O}_{p}(0)\end{split}
\end{equation*}

\subsection{Appendix: Manipulation of discrete\sphinxhyphen{}time system matrix equation into correlation matrix relationships}
\label{\detokenize{theory/srim:appendix-manipulation-of-discrete-time-system-matrix-equation-into-correlation-matrix-relationships}}
\sphinxAtStartPar
In (\sphinxhref{https://doi.org/10.2514/2.4068}{Juang 1997}), the discrete\sphinxhyphen{}time
system matrix equation is manipulated into a form describing the
relationship between correlation matrices \(\mathbf{R}_{yy}\),
\(\mathbf{R}_{yu}\), \(\mathbf{R}_{uu}\), and
\(\mathbf{R}_{xx}\).

\sphinxAtStartPar
Post\sphinxhyphen{}multiplying the {\hyperref[\detokenize{theory/srim:discrete-time-system-matrix-equation}]{\sphinxcrossref{\DUrole{std,std-ref}{discrete\sphinxhyphen{}time system matrix
equation}}}} by
\(\frac{1}{N}\mathbf{U}_{p}^{T}(k)\):
\begin{equation*}
\begin{split}\begin{aligned}
\frac{1}{N}\mathbf{Y}_{p}(k)\mathbf{U}_{p}^{T}(k) &= \mathcal{O}_{p}\frac{1}{N}\mathbf{X}(k)\mathbf{U}_{p}^{T}(k) + \mathcal{T}_{p}\frac{1}{N}\mathbf{U}_{p}(k)\mathbf{U}_{p}^{T}(k)
\\
\mathbf{R}_{yu} &= \mathcal{O}_{p}\mathbf{R}_{xu} + \mathcal{T}_{p}\mathbf{R}_{uu}
\\
\mathcal{T}_{p} &= \left( \mathbf{R}_{yu} - \mathcal{O}_{p}\mathbf{R}_{xu} \right)\mathbf{R}_{uu}^{-1}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Post\sphinxhyphen{}multiplying by \(\frac{1}{N}\mathbf{Y}_{p}^{T}(k)\):
\begin{equation*}
\begin{split}\begin{aligned}
\frac{1}{N}\mathbf{Y}_{p}(k)\mathbf{Y}_{p}^{T}(k) &= \mathcal{O}_{p}\frac{1}{N}\mathbf{X}(k)\mathbf{Y}_{p}^{T}(k) + \mathcal{T}_{p}\frac{1}{N}\mathbf{U}_{p}(k)\mathbf{Y}_{p}^{T}(k)
\\
\mathbf{R}_{yy} &= \mathcal{O}_{p}\mathbf{R}_{yx}^{T} + \mathcal{T}_{p}\mathbf{R}_{yu}^{T}
\\
\mathbf{R}_{yy} &= \mathcal{O}_{p}\mathbf{R}_{yx}^{T} + \left( \mathbf{R}_{yu} - \mathcal{O}_{p}\mathbf{R}_{xu} \right)\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Post\sphinxhyphen{}multiplying by \(\frac{1}{N}\mathbf{X}_{p}^{T}(k)\):
\begin{equation*}
\begin{split}\begin{aligned}
\frac{1}{N}\mathbf{Y}_{p}(k)\mathbf{X}_{p}^{T}(k) &= \mathcal{O}_{p}\frac{1}{N}\mathbf{X}(k)\mathbf{X}_{p}^{T}(k) + \mathcal{T}_{p}\frac{1}{N}\mathbf{U}_{p}(k)\mathbf{X}_{p}^{T}(k)
\\
\mathbf{R}_{yx} &= \mathcal{O}_{p}\mathbf{R}_{xx} + \mathcal{T}_{p}\mathbf{R}_{xu}^{T}
\\
\mathbf{R}_{yx} &= \mathcal{O}_{p}\mathbf{R}_{xx} + \left( \mathbf{R}_{yu} - \mathcal{O}_{p}\mathbf{R}_{xu} \right)\mathbf{R}_{uu}^{-1}\mathbf{R}_{xu}^{T}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Substituting the equation for \(\mathbf{R}_{yx}\) into the equation
for \(\mathbf{R}_{yy}\):
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{R}_{yy} =& ~\mathcal{O}_{p}
\left(\mathcal{O}_{p}\mathbf{R}_{xx} + \left( \mathbf{R}_{yu} - \mathcal{O}_{p}\mathbf{R}_{xu} \right)\mathbf{R}_{uu}^{-1}\mathbf{R}_{xu}^{T}\right)^{T}
\\
&+
\left( \mathbf{R}_{yu} - \mathcal{O}_{p}\mathbf{R}_{xu} \right)\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T}
\\
=& ~\mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T}
 + \mathcal{O}_{p}\mathbf{R}_{xu}\mathbf{R}_{uu}^{-1} \left( \mathbf{R}_{yu}^{T} - \mathbf{R}_{xu}^{T}\mathcal{O}_{p}^{T} \right)
\\
&+
\left( \mathbf{R}_{yu} - \mathcal{O}_{p}\mathbf{R}_{xu} \right)\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T}
\\
=& ~\mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T}
 + \mathcal{O}_{p}\mathbf{R}_{xu}\mathbf{R}_{uu}^{-1}  \mathbf{R}_{yu}^{T} - \mathcal{O}_{p}\mathbf{R}_{xu}\mathbf{R}_{uu}^{-1} \mathbf{R}_{xu}^{T}\mathcal{O}_{p}^{T}
\\
&+
 \mathbf{R}_{yu}\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T} - \mathcal{O}_{p}\mathbf{R}_{xu} \mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T}
\\
=& ~\mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T}
 - \mathcal{O}_{p}\mathbf{R}_{xu}\mathbf{R}_{uu}^{-1} \mathbf{R}_{xu}^{T}\mathcal{O}_{p}^{T} +
 \mathbf{R}_{yu}\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Moving all of the terms that can be composed with measured data to the
left side:
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{R}_{yy} - \mathbf{R}_{yu}\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T}
&= \mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T} - \mathcal{O}_{p}\mathbf{R}_{xu}\mathbf{R}_{uu}^{-1} \mathbf{R}_{xu}^{T}\mathcal{O}_{p}^{T} \\
&= \mathcal{O}_{p}\left( \mathbf{R}_{xx} - \mathbf{R}_{xu}\mathbf{R}_{uu}^{-1} \mathbf{R}_{xu}^{T} \right) \mathcal{O}_{p}^{T}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
We make the assumption that all current and future input data is
uncorrelated with the current state, which means that the average of the
products \(\mathbf{x}(k)\mathbf{u}(k+i), ~~ i \in [0,1,2,\dots]\) is
zero. This gives:
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{R}_{xu} &=
\frac{1}{N}
\begin{bmatrix}
\sum_{j=0}^{N-1}\mathbf{x}(k+j)\mathbf{u}(k+j) \\
\sum_{j=0}^{N-1}\mathbf{x}(k+j)\mathbf{u}(k+j+1) \\
\sum_{j=0}^{N-1}\mathbf{x}(k+j)\mathbf{u}(k+j+2) \\
\vdots \\
\sum_{j=0}^{N-1}\mathbf{x}(k+j)\mathbf{u}(k+j+p-1)
\end{bmatrix}^{T} \\
&=
\mathbf{0}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
in order to yield:
\begin{equation*}
\begin{split}\mathbf{R}_{yy} - \mathbf{R}_{yu}\mathbf{R}_{uu}^{-1}\mathbf{R}_{yu}^{T} = \mathcal{O}_{p}\mathbf{R}_{xx}\mathcal{O}_{p}^{T}~.\end{split}
\end{equation*}
\sphinxstepscope


\chapter{Examples}
\label{\detokenize{examples/index:examples}}\label{\detokenize{examples/index::doc}}
\sphinxstepscope


\section{Overview of the \sphinxstyleliteralintitle{\sphinxupquote{mdof}} package}
\label{\detokenize{examples/00_Overview:Overview-of-the-mdof-package}}\label{\detokenize{examples/00_Overview::doc}}


\sphinxAtStartPar
\sphinxincludegraphics[width=200\sphinxpxdimen]{{mdof_overview}.png}



\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{mdof}} package is designed to provide a convenient interface for computing dynamic analyses of structural vibrations.


\subsection{Installation}
\label{\detokenize{examples/00_Overview:Installation}}
\sphinxAtStartPar
If you’d like to install \sphinxcode{\sphinxupquote{mdof}} in your own environment to work with it locally, install mdof from \sphinxhref{https://pypi.org/project/mdof/}{pypi}. In your environment manager (e.g., Anaconda),

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip\PYG{+w}{ }install\PYG{+w}{ }mdof
\end{sphinxVerbatim}


\subsection{Import}
\label{\detokenize{examples/00_Overview:Import}}
\sphinxAtStartPar
In Python, import the package.

\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{mdof}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Investigate Structural Vibrations}
\label{\detokenize{examples/00_Overview:Investigate-Structural-Vibrations}}
\sphinxAtStartPar
Load an the input motion, output motion, and time vector for a mystery structural system.





\sphinxAtStartPar
\sphinxincludegraphics[width=550\sphinxpxdimen]{{mystery_system}.png}





\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{n}{input\PYGZus{}motion} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uploads/input\PYGZus{}motion.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{output\PYGZus{}motion} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uploads/output\PYGZus{}motion.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{times} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uploads/times.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{n}{plot\PYGZus{}io}
\PYG{n}{plot\PYGZus{}io}\PYG{p}{(}\PYG{n}{input\PYGZus{}motion}\PYG{p}{,} \PYG{n}{output\PYGZus{}motion}\PYG{p}{,} \PYG{n}{times}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=801\sphinxpxdimen,height=293\sphinxpxdimen]{{examples_00_Overview_12_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Inverse Eigenanalysis with \sphinxstyleliteralintitle{\sphinxupquote{mdof.eigid()}}}
\label{\detokenize{examples/00_Overview:Inverse-Eigenanalysis-with-mdof.eigid()}}




\sphinxAtStartPar
\sphinxincludegraphics[width=550\sphinxpxdimen]{{eigid}.png}





\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{eigvecs}\PYG{p}{,} \PYG{n}{eigvals} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{eigid}\PYG{p}{(}\PYG{n}{input\PYGZus{}motion}\PYG{p}{,} \PYG{n}{output\PYGZus{}motion}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 4700/4701 [00:00<00:00, 83230.16it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{eigvecs}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{ }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{eigvals}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
eigvecs=array([0.98491199+0.16330168j, 0.98491199-0.16330168j])
 eigvals=array([[ 0.71332805+0.j        ,  0.71332805-0.j        ],
       [-0.00497201+0.70081265j, -0.00497201-0.70081265j]])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{State Space Realization with \sphinxstyleliteralintitle{\sphinxupquote{mdof.sysid()}}}
\label{\detokenize{examples/00_Overview:State-Space-Realization-with-mdof.sysid()}}




\sphinxAtStartPar
\sphinxincludegraphics[width=550\sphinxpxdimen]{{sysid}.png}





\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{,}\PYG{n}{C}\PYG{p}{,}\PYG{n}{D} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{sysid}\PYG{p}{(}\PYG{n}{input\PYGZus{}motion}\PYG{p}{,} \PYG{n}{output\PYGZus{}motion}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 4700/4701 [00:00<00:00, 84670.45it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{A}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{B}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{C}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{D}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
A=array([[ 0.98607055,  0.16621799],
       [-0.16044462,  0.98375342]])
B=array([[-0.1743355 ],
       [-0.10978558]])
C=array([[-0.05126065,  0.08870003]])
D=array([[-0.09489982]])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Modal Estimation with \sphinxstyleliteralintitle{\sphinxupquote{mdof.modes()}}}
\label{\detokenize{examples/00_Overview:Modal-Estimation-with-mdof.modes()}}




\sphinxAtStartPar
\sphinxincludegraphics[width=550\sphinxpxdimen]{{modal}.png}





\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{modes} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{modes}\PYG{p}{(}\PYG{n}{input\PYGZus{}motion}\PYG{p}{,} \PYG{n}{output\PYGZus{}motion}\PYG{p}{,} \PYG{n}{dt}\PYG{o}{=}\PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 4700/4701 [00:00<00:00, 89741.83it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[9]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{n}{print\PYGZus{}modes}
\PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{modes}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO      MPC       EMACO*MPC
      1.147      0.01       1.0        1.0        1.0
Mean Period(s): 1.1471474419090963
Standard Dev(s): 0.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Spectra with \sphinxstyleliteralintitle{\sphinxupquote{power\_transfer()}} and \sphinxstyleliteralintitle{\sphinxupquote{spectrum\_modes()}}}
\label{\detokenize{examples/00_Overview:Spectra-with-power_transfer()-and-spectrum_modes()}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[10]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{transform} \PYG{k+kn}{import} \PYG{n}{power\PYGZus{}transfer}
\PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{power\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{input\PYGZus{}motion}\PYG{p}{,} \PYG{n}{output\PYGZus{}motion}\PYG{p}{,} \PYG{n}{step}\PYG{o}{=}\PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{period\PYGZus{}band}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{modal} \PYG{k+kn}{import} \PYG{n}{spectrum\PYGZus{}modes}
\PYG{n}{peak\PYGZus{}period}\PYG{p}{,} \PYG{n}{peak\PYGZus{}amplitude} \PYG{o}{=} \PYG{n}{spectrum\PYGZus{}modes}\PYG{p}{(}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{peak\PYGZus{}period}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
peak\_period=array([1.14503817])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{n}{plot\PYGZus{}transfer}
\PYG{n}{plot\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{periods}\PYG{p}{,}\PYG{n}{amplitudes}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{plotly}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{rendered_html}


\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{rendered_html}


\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Stablization Diagram with \sphinxstyleliteralintitle{\sphinxupquote{stabilization()}}}
\label{\detokenize{examples/00_Overview:Stablization-Diagram-with-stabilization()}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[13]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{macro} \PYG{k+kn}{import} \PYG{n}{stabilization}
\PYG{n}{stabilization}\PYG{p}{(}\PYG{n}{input\PYGZus{}motion}\PYG{p}{,} \PYG{n}{output\PYGZus{}motion}\PYG{p}{,} \PYG{n}{dt}\PYG{o}{=}\PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{times}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{orders}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{n}{plotly}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 4700/4701 [00:00<00:00, 103130.17it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 43797.93it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 23331.09it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 18435.29it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 13157.71it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 9773.15it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 6034.75it/s]
100\%|█████████▉| 4700/4701 [00:00<00:00, 4881.76it/s]
100\%|█████████▉| 4700/4701 [00:01<00:00, 3857.66it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{rendered_html}


\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{rendered_html}


\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\section{Introduction to SISO}
\label{\detokenize{examples/01_SISO_Intro:Introduction-to-SISO}}\label{\detokenize{examples/01_SISO_Intro::doc}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{testing} \PYG{k+kn}{import} \PYG{n}{test\PYGZus{}method}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{config} \PYG{k+kn}{import} \PYG{n}{Config}
\PYG{k+kn}{import} \PYG{n+nn}{mdof}
\PYG{k+kn}{from} \PYG{n+nn}{mdof} \PYG{k+kn}{import} \PYG{n}{modal}\PYG{p}{,} \PYG{n}{transform}
\PYG{k+kn}{from} \PYG{n+nn}{control} \PYG{k+kn}{import} \PYG{n}{ss}\PYG{p}{,} \PYG{n}{forced\PYGZus{}response}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Define a SDOF system}
\label{\detokenize{examples/01_SISO_Intro:Define-a-SDOF-system}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
m
&
\sphinxAtStartPar
mass
\\
\sphinxhline
\sphinxAtStartPar
k
&
\sphinxAtStartPar
stiffness
\\
\sphinxhline
\sphinxAtStartPar
c
&
\sphinxAtStartPar
damping coefficient
\\
\sphinxhline
\sphinxAtStartPar
nt
&
\sphinxAtStartPar
number of timesteps
\\
\sphinxhline
\sphinxAtStartPar
dt
&
\sphinxAtStartPar
timestep
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxincludegraphics[width=756\sphinxpxdimen,height=201\sphinxpxdimen]{{sdof}.png}

\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} parameters of SDOF system}
\PYG{n}{mass} \PYG{o}{=} \PYG{l+m+mi}{1}       \PYG{c+c1}{\PYGZsh{} mass}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{30}         \PYG{c+c1}{\PYGZsh{} stiffness}
\PYG{n}{zeta} \PYG{o}{=} \PYG{l+m+mf}{0.01}    \PYG{c+c1}{\PYGZsh{} damping ratio}
\PYG{n}{omega\PYGZus{}n} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{k}\PYG{o}{/}\PYG{n}{mass}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} natural frequency (rad/s)}
\PYG{n}{Tn} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}  \PYG{c+c1}{\PYGZsh{} natural periods (s)}
\PYG{n}{c} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{mass}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}    \PYG{c+c1}{\PYGZsh{} damping coefficient}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{natural period: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Tn}\PYG{l+s+si}{:}\PYG{l+s+s2}{\PYGZlt{}3.5}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{damping ratio: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{zeta}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} forcing frequencies (rad/s)}
\PYG{n}{omega\PYGZus{}f} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{0.017}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{p}{,} \PYG{l+m+mf}{0.14}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{p}{,} \PYG{l+m+mf}{0.467}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{p}{,} \PYG{l+m+mf}{0.186}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{p}{,} \PYG{l+m+mf}{0.2937}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{p}{]}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
natural period: 1.1471s
damping ratio: 0.01
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} forcing function (input)}
\PYG{n}{nt} \PYG{o}{=} \PYG{l+m+mi}{5000}       \PYG{c+c1}{\PYGZsh{} number of timesteps}
\PYG{n}{dt} \PYG{o}{=} \PYG{l+m+mf}{0.03}       \PYG{c+c1}{\PYGZsh{} timestep}
\PYG{n}{tf} \PYG{o}{=} \PYG{n}{nt}\PYG{o}{*}\PYG{n}{dt}      \PYG{c+c1}{\PYGZsh{} final time}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n}{start} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{stop} \PYG{o}{=} \PYG{n}{tf}\PYG{p}{,} \PYG{n}{step} \PYG{o}{=} \PYG{n}{dt}\PYG{p}{)}
\PYG{n}{f} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{p}{[}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{t} \PYG{k}{for} \PYG{n}{omega} \PYG{o+ow}{in} \PYG{n}{omega\PYGZus{}f}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} displacement response (analytical solution) (output)}
\PYG{n}{omega\PYGZus{}D} \PYG{o}{=} \PYG{n}{omega\PYGZus{}n}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{zeta}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{omega\PYGZus{}f}\PYG{p}{)}\PYG{p}{,}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i}\PYG{p}{,}\PYG{n}{omega} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{omega\PYGZus{}f}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{C3} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{k}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
    \PYG{n}{C4} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
    \PYG{n}{C1} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{C4}
    \PYG{n}{C2} \PYG{o}{=} \PYG{p}{(}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{o}{*}\PYG{n}{C1}\PYG{o}{\PYGZhy{}}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{C3}\PYG{p}{)}\PYG{o}{/}\PYG{n}{omega\PYGZus{}D}
    \PYG{n}{y}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{C1}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{omega\PYGZus{}D}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}\PYG{o}{+}\PYG{n}{C2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{omega\PYGZus{}D}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{C3}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)} \PYG{o}{+} \PYG{n}{C4}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} plot input vs. output}
\PYG{n}{plot\PYGZus{}io}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SDOF Displacement Response to Sinusoidal Forcing}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=801\sphinxpxdimen,height=301\sphinxpxdimen]{{examples_01_SISO_Intro_7_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Perform System Identification}
\label{\detokenize{examples/01_SISO_Intro:Perform-System-Identification}}

\subsubsection{Transfer Function Methods}
\label{\detokenize{examples/01_SISO_Intro:Transfer-Function-Methods}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Set parameters}
\PYG{n}{conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{damping} \PYG{o}{=} \PYG{n}{zeta}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{0.01}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Period band (s)}

\PYG{c+c1}{\PYGZsh{} A place to store models and their predictions}
\PYG{n}{transfer\PYGZus{}models} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Generate a transfer function representation of the system}
\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier Transform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{step}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} transfer\PYGZus{}models[\PYGZdq{}Response Spectrum\PYGZdq{}] = transform.response\PYGZus{}transfer(inputs=f, outputs=y, step=dt, pseudo=False, threads=8, periods=(*conf.period\PYGZus{}band, 500), **conf)}

\PYG{c+c1}{\PYGZsh{} Determing the fundamental frequency}
\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{,} \PYG{n}{fourier\PYGZus{}amplitudes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{spectrum\PYGZus{}modes}\PYG{p}{(}\PYG{o}{*}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier Transform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} response\PYGZus{}periods, response\PYGZus{}amplitudes = modal.spectrum\PYGZus{}modes(*transfer\PYGZus{}models[\PYGZdq{}Response Spectrum\PYGZdq{}],height=0.1)}
\PYG{n}{plot\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Transfer Functions}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{color\PYGZus{}cycle} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{rcParams}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{axes.prop\PYGZus{}cycle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{by\PYGZus{}key}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} plt.vlines([fourier\PYGZus{}periods[0], response\PYGZus{}periods[0]],ymin=0,ymax=1,linestyles=\PYGZsq{}\PYGZhy{}\PYGZhy{}\PYGZsq{},colors=color\PYGZus{}cycle[:2])}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mf}{0.05}\PYG{p}{,}\PYG{l+m+mf}{0.9}\PYG{p}{,}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}T\PYGZus{}}\PYG{l+s+si}{\PYGZob{}fourier\PYGZcb{}}\PYG{l+s+s2}{\PYGZdl{} = }\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plt.text(response\PYGZus{}periods[0]+0.05,0.8,r\PYGZdq{}\PYGZdl{}T\PYGZus{}\PYGZob{}response\PYGZcb{}\PYGZdl{} = \PYGZdq{}+str(np.round(response\PYGZus{}periods[0],3)),fontsize=15)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band}\PYG{p}{)}\PYG{p}{;}
\PYG{c+c1}{\PYGZsh{} plt.gcf().set\PYGZus{}figwidth(9)}
\PYG{c+c1}{\PYGZsh{} plt.legend();}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=557\sphinxpxdimen,height=316\sphinxpxdimen]{{examples_01_SISO_Intro_10_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{State Space Methods}
\label{\detokenize{examples/01_SISO_Intro:State-Space-Methods}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Generate a state space realization of the system}
\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{,}\PYG{n}{C}\PYG{p}{,}\PYG{n}{D} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{system}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{r}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Obtain natural period and damping ratio from the state space model}
\PYG{n}{ss\PYGZus{}modes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{system\PYGZus{}modes}\PYG{p}{(}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{,}\PYG{n}{C}\PYG{p}{,}\PYG{n}{D}\PYG{p}{)}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{,}\PYG{n}{outlook}\PYG{o}{=}\PYG{l+m+mi}{190}\PYG{p}{)}
\PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{p}{,} \PYG{n}{Tn}\PYG{o}{=}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{zeta}\PYG{o}{=}\PYG{n}{zeta}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 4700/4701 [00:00<00:00, 86808.38it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO      MPC       EMACO*MPC     T \% error    ζ \% error
      1.147      0.01       1.0        1.0        1.0          9.678e-14    1.622e-11
Mean Period(s): 1.1471474419090963
Standard Dev(s): 0.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Reproduce the response with the state space model}
\PYG{n}{y\PYGZus{}mdof} \PYG{o}{=} \PYG{n}{forced\PYGZus{}response}\PYG{p}{(}\PYG{n}{ss}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{,}\PYG{n}{C}\PYG{p}{,}\PYG{n}{D}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{)}\PYG{p}{,} \PYG{n}{T}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{U}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{squeeze}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{return\PYGZus{}x}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{o}{.}\PYG{n}{outputs}
\PYG{n}{plot\PYGZus{}pred}\PYG{p}{(}\PYG{n}{ytrue}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{models}\PYG{o}{=}\PYG{n}{y\PYGZus{}mdof}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{System ID Predicted Displacement Response}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=776\sphinxpxdimen,height=409\sphinxpxdimen]{{examples_01_SISO_Intro_13_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Breakdown of State Space Methods}
\label{\detokenize{examples/01_SISO_Intro:Breakdown-of-State-Space-Methods}}

\subsubsection{General Parameters}
\label{\detokenize{examples/01_SISO_Intro:General-Parameters}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{p}}
&
\sphinxAtStartPar
number of output channels
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{q}}
&
\sphinxAtStartPar
number of input channels
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nt}}
&
\sphinxAtStartPar
number of timesteps
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dt}}
&
\sphinxAtStartPar
timestep
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{decimation}}
&
\sphinxAtStartPar
decimation (downsampling) factor
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{order}}
&
\sphinxAtStartPar
model order (2 times number of DOF)
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{Parameters for Mode Validation}
\label{\detokenize{examples/01_SISO_Intro:Parameters-for-Mode-Validation}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{outlook}}
&
\sphinxAtStartPar
number of steps used for temporal consistency in EMAC
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{Method Inputs}
\label{\detokenize{examples/01_SISO_Intro:Method-Inputs}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[9]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Set parameters}
\PYG{n}{conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{m}  \PYG{o}{=} \PYG{l+m+mi}{1500}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{horizon} \PYG{o}{=} \PYG{l+m+mi}{150}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{nc} \PYG{o}{=} \PYG{l+m+mi}{150}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{order}  \PYG{o}{=}   \PYG{l+m+mi}{2}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{a}  \PYG{o}{=}   \PYG{l+m+mi}{0}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{b}  \PYG{o}{=}   \PYG{l+m+mi}{0}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{l}  \PYG{o}{=}  \PYG{l+m+mi}{10}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{g}  \PYG{o}{=}   \PYG{l+m+mi}{3}

\PYG{c+c1}{\PYGZsh{} A place to store models and their predictions}
\PYG{n}{models} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Specific to Observer Kalman Identification (OKID)}
\label{\detokenize{examples/01_SISO_Intro:Specific-to-Observer-Kalman-Identification-(OKID)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{m}}
&
\sphinxAtStartPar
number of Markov parameters to compute (at most = nt)
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{Specific to Eigensystem Realization Algorithm (ERA)}
\label{\detokenize{examples/01_SISO_Intro:Specific-to-Eigensystem-Realization-Algorithm-(ERA)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{horizon}}
&
\sphinxAtStartPar
number of observability parameters, or prediction horizon
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nc}}
&
\sphinxAtStartPar
number of controllability parameters
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{OKID\sphinxhyphen{}ERA}
\label{\detokenize{examples/01_SISO_Intro:OKID-ERA}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[10]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} OKID\PYGZhy{}ERA}
\PYG{n}{method} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{okid\PYGZhy{}era}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{models}\PYG{p}{[}\PYG{n}{method}\PYG{p}{]} \PYG{o}{=} \PYG{n}{test\PYGZus{}method}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{n}{method}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{dt}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{models}\PYG{p}{[}\PYG{n}{method}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{modes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{Tn}\PYG{o}{=}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{zeta}\PYG{o}{=}\PYG{n}{zeta}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO      MPC       EMACO*MPC     T \% error    ζ \% error
      1.801      0.3442     1.0        1.0        1.0          57.01        3.342e+03
Mean Period(s): 1.8011804589415248
Standard Dev(s): 0.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Specific to Data Correlations (DC)}
\label{\detokenize{examples/01_SISO_Intro:Specific-to-Data-Correlations-(DC)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{a}}
&
\sphinxAtStartPar
(alpha) number of additional block rows in Hankel matrix of correlation matrices
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{b}}
&
\sphinxAtStartPar
(beta) number of additional block columns in Hankel matrix of correlation matrices
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{l}}
&
\sphinxAtStartPar
initial lag
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{g}}
&
\sphinxAtStartPar
lag (gap) between correlations
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{OKID\sphinxhyphen{}ERA\sphinxhyphen{}DC}
\label{\detokenize{examples/01_SISO_Intro:OKID-ERA-DC}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} OKID\PYGZhy{}ERA\PYGZhy{}DC}
\PYG{n}{method} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{okid\PYGZhy{}era\PYGZhy{}dc}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{models}\PYG{p}{[}\PYG{n}{method}\PYG{p}{]} \PYG{o}{=} \PYG{n}{test\PYGZus{}method}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{n}{method}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{dt}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{models}\PYG{p}{[}\PYG{n}{method}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{modes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{Tn}\PYG{o}{=}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{zeta}\PYG{o}{=}\PYG{n}{zeta}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO      MPC       EMACO*MPC     T \% error    ζ \% error
      1.776      0.2423     1.0        1.0        1.0          54.85        2.323e+03
Mean Period(s): 1.7763378693304586
Standard Dev(s): 0.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Specific to System Realization with Information Matrix (SRIM)}
\label{\detokenize{examples/01_SISO_Intro:Specific-to-System-Realization-with-Information-Matrix-(SRIM)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{horizon}}
&
\sphinxAtStartPar
number of steps used for identification, or prediction horizon
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{SRIM}
\label{\detokenize{examples/01_SISO_Intro:SRIM}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} SRIM}
\PYG{n}{method} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{srim}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{models}\PYG{p}{[}\PYG{n}{method}\PYG{p}{]} \PYG{o}{=} \PYG{n}{test\PYGZus{}method}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{n}{method}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{f}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{dt}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{models}\PYG{p}{[}\PYG{n}{method}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{modes}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{Tn}\PYG{o}{=}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{zeta}\PYG{o}{=}\PYG{n}{zeta}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 4850/4851 [00:00<00:00, 80591.63it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO      MPC       EMACO*MPC     T \% error    ζ \% error
      1.147      0.01       1.0        1.0        1.0          1.295e-11    8.338e-10
Mean Period(s): 1.1471474419092438
Standard Dev(s): 0.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Compare Methods}
\label{\detokenize{examples/01_SISO_Intro:Compare-Methods}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[13]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plot\PYGZus{}models}\PYG{p}{(}\PYG{n}{models}\PYG{p}{,} \PYG{n}{Tn}\PYG{p}{,} \PYG{n}{zeta}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=1301\sphinxpxdimen,height=651\sphinxpxdimen]{{examples_01_SISO_Intro_30_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[14]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plot\PYGZus{}pred}\PYG{p}{(}\PYG{n}{ytrue}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{models}\PYG{o}{=}\PYG{n}{models}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{System ID Predicted Displacement Response}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=776\sphinxpxdimen,height=409\sphinxpxdimen]{{examples_01_SISO_Intro_31_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\section{SISO for a Ground Motion Event}
\label{\detokenize{examples/02_SISO_Event:SISO-for-a-Ground-Motion-Event}}\label{\detokenize{examples/02_SISO_Event::doc}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{mdof}
\PYG{k+kn}{from} \PYG{n+nn}{mdof} \PYG{k+kn}{import} \PYG{n}{modal}\PYG{p}{,} \PYG{n}{transform}
\PYG{k+kn}{import} \PYG{n+nn}{sdof}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{numpy} \PYG{k+kn}{import} \PYG{n}{linspace}\PYG{p}{,} \PYG{n}{sqrt}\PYG{p}{,} \PYG{n}{pi}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{config} \PYG{k+kn}{import} \PYG{n}{Config}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{numerics} \PYG{k+kn}{import} \PYG{n}{decimate}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Unknown system with one input and one output}
\label{\detokenize{examples/02_SISO_Event:Unknown-system-with-one-input-and-one-output}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\(\omega_n\)
&
\sphinxAtStartPar
natural period
\\
\sphinxhline
\sphinxAtStartPar
\(\zeta\)
&
\sphinxAtStartPar
damping ratio
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxincludegraphics[width=2764\sphinxpxdimen,height=720\sphinxpxdimen]{{sdof2}.png}


\subsection{Configure}
\label{\detokenize{examples/02_SISO_Event:Configure}}

\subsubsection{Inputs}
\label{\detokenize{examples/02_SISO_Event:Inputs}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{inputs}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{uploads/elcentro.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{dt} \PYG{o}{=} \PYG{l+m+mf}{0.02}

\PYG{c+c1}{\PYGZsh{} ta = np.arange(0, inputs.size*dt, dt)}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{(}\PYG{n}{inputs}\PYG{o}{.}\PYG{n}{size}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{dt}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Outputs}
\label{\detokenize{examples/02_SISO_Event:Outputs}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{outputs} \PYG{o}{=} \PYG{k+kc}{None}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Example SDOF system}
\PYG{n}{mass} \PYG{o}{=} \PYG{l+m+mi}{1}       \PYG{c+c1}{\PYGZsh{} mass}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{30}         \PYG{c+c1}{\PYGZsh{} stiffness}
\PYG{n}{zeta} \PYG{o}{=} \PYG{l+m+mf}{0.01}    \PYG{c+c1}{\PYGZsh{} damping ratio}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Generate output if one was not given:

\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{if} \PYG{n}{outputs} \PYG{o+ow}{is} \PYG{k+kc}{None}\PYG{p}{:}
    \PYG{n}{omega\PYGZus{}n} \PYG{o}{=} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{k}\PYG{o}{/}\PYG{n}{mass}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} natural frequency (rad/s)}
    \PYG{n}{Tn} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}  \PYG{c+c1}{\PYGZsh{} natural periods (s)}
    \PYG{n}{c} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{mass}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}    \PYG{c+c1}{\PYGZsh{} damping coefficient}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{natural period: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Tn}\PYG{l+s+si}{:}\PYG{l+s+s2}{\PYGZlt{}3.5}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{damping ratio:  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{zeta}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{displ}\PYG{p}{,} \PYG{n}{veloc}\PYG{p}{,} \PYG{n}{outputs} \PYG{o}{=} \PYG{n}{sdof}\PYG{o}{.}\PYG{n}{integrate}\PYG{p}{(}\PYG{n}{mass}\PYG{p}{,}\PYG{n}{c}\PYG{p}{,}\PYG{n}{k}\PYG{p}{,}\PYG{n}{inputs}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
natural period: 1.1471s
damping ratio:  0.01
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Method}
\label{\detokenize{examples/02_SISO_Event:Method}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{c+c1}{\PYGZsh{} transfer function decimation}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Analysis with System Identification}
\label{\detokenize{examples/02_SISO_Event:Analysis-with-System-Identification}}

\subsubsection{Transfer Function Methods}
\label{\detokenize{examples/02_SISO_Event:Transfer-Function-Methods}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Set parameters}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{damping} \PYG{o}{=} \PYG{n}{zeta}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Period band (s)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{pseudo} \PYG{o}{=} \PYG{k+kc}{True} \PYG{c+c1}{\PYGZsh{} use pseudo accelerations (Sa)}

\PYG{c+c1}{\PYGZsh{} A place to store models and their predictions}
\PYG{n}{transfer\PYGZus{}models} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Generate a transfer function representation of the system}
\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier Transform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Response Spectrum}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{response\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Determing the fundamental frequency}
\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{,} \PYG{n}{fourier\PYGZus{}amplitudes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{spectrum\PYGZus{}modes}\PYG{p}{(}\PYG{o}{*}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier Transform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{response\PYGZus{}periods}\PYG{p}{,} \PYG{n}{response\PYGZus{}amplitudes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{spectrum\PYGZus{}modes}\PYG{p}{(}\PYG{o}{*}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Response Spectrum}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{height}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{State Space Methods}
\label{\detokenize{examples/02_SISO_Event:State-Space-Methods}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Generate a state space realization of the system}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{order} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{horizon} \PYG{o}{=} \PYG{l+m+mi}{300}
\PYG{n}{realization} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{system}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{srim}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Obtain natural period and damping ratio from the state space model}
\PYG{n}{ss\PYGZus{}modes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{system\PYGZus{}modes}\PYG{p}{(}\PYG{n}{realization}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{p}{,} \PYG{n}{Tn}\PYG{o}{=}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{zeta}\PYG{o}{=}\PYG{n}{zeta}\PYG{p}{)}

\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 3695/3696 [00:00<00:00, 28868.69it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC          T \% error    ζ \% error
      1.148      0.00998    1.0        1.0        1.0          0.0999       -0.1995
Mean Period(s): 1.1482934446028523
Standard Dev(s): 0.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Visualize Transfer Functions vs. State Space Methodds}
\label{\detokenize{examples/02_SISO_Event:Visualize-Transfer-Functions-vs.-State-Space-Methodds}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plot\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Transfer Functions}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{color\PYGZus{}cycle} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{rcParams}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{axes.prop\PYGZus{}cycle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{by\PYGZus{}key}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{p}{[}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{response\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}\PYG{n}{ymin}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{ymax}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{colors}\PYG{o}{=}\PYG{n}{color\PYGZus{}cycle}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{ss\PYGZus{}modes}\PYG{p}{[}\PYG{n+nb}{next}\PYG{p}{(}\PYG{n+nb}{iter}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{ymin}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{ymax}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{colors}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{State Space}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mf}{0.05}\PYG{p}{,}\PYG{l+m+mf}{0.975}\PYG{p}{,}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}T\PYGZus{}}\PYG{l+s+si}{\PYGZob{}fourier\PYGZcb{}}\PYG{l+s+s2}{\PYGZdl{} = }\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{response\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mf}{0.05}\PYG{p}{,}\PYG{l+m+mf}{0.875}\PYG{p}{,}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}T\PYGZus{}}\PYG{l+s+si}{\PYGZob{}response\PYGZcb{}}\PYG{l+s+s2}{\PYGZdl{} = }\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{response\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mf}{1.1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{c+c1}{\PYGZsh{} fig, ax = plt.subplots(figsize=(5,3))}
\PYG{c+c1}{\PYGZsh{} ax.plot(*transfer\PYGZus{}models[\PYGZdq{}Fourier Transform\PYGZdq{}] )}
\PYG{c+c1}{\PYGZsh{} plt.tick\PYGZus{}params(left = False, right = False , labelleft = False ,}
\PYG{c+c1}{\PYGZsh{}                 labelbottom = False, bottom = False)}
\PYG{c+c1}{\PYGZsh{} ax.set\PYGZus{}xlabel(\PYGZdq{}Period (s)\PYGZdq{})}
\PYG{c+c1}{\PYGZsh{} ax.set\PYGZus{}ylabel(\PYGZdq{}Amplitude\PYGZdq{})}
\PYG{c+c1}{\PYGZsh{} plt.gcf().savefig(\PYGZdq{}output/transfer.svg\PYGZdq{});}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=842\sphinxpxdimen,height=393\sphinxpxdimen]{{examples_02_SISO_Event_20_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{assert} \PYG{n}{np}\PYG{o}{.}\PYG{n}{isclose}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{ss\PYGZus{}modes}\PYG{p}{[}\PYG{n+nb}{next}\PYG{p}{(}\PYG{n+nb}{iter}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{Tn}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{ss\PYGZus{}modes}\PYG{p}{[}\PYG{n+nb}{next}\PYG{p}{(}\PYG{n+nb}{iter}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{k}{assert} \PYG{n}{np}\PYG{o}{.}\PYG{n}{isclose}\PYG{p}{(}\PYG{n}{Tn}\PYG{p}{,} \PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plot\PYGZus{}io}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SDOF Response}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=1201\sphinxpxdimen,height=401\sphinxpxdimen]{{examples_02_SISO_Event_22_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Reproduce the response with the state space model}
\PYG{k+kn}{from} \PYG{n+nn}{control} \PYG{k+kn}{import} \PYG{n}{ss}\PYG{p}{,} \PYG{n}{forced\PYGZus{}response}
\PYG{n}{out\PYGZus{}mdof} \PYG{o}{=} \PYG{n}{forced\PYGZus{}response}\PYG{p}{(}\PYG{n}{ss}\PYG{p}{(}\PYG{o}{*}\PYG{n}{realization}\PYG{p}{,}\PYG{n}{dt}\PYG{o}{*}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{U}\PYG{o}{=}\PYG{n}{decimate}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{,}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{squeeze}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{return\PYGZus{}x}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{o}{.}\PYG{n}{outputs}
\PYG{n}{plot\PYGZus{}pred}\PYG{p}{(}\PYG{n}{ytrue}\PYG{o}{=}\PYG{n}{decimate}\PYG{p}{(}\PYG{n}{outputs}\PYG{p}{,}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{models}\PYG{o}{=}\PYG{n}{out\PYGZus{}mdof}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{decimate}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{State Space Model Displacement Response}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} color\PYGZus{}cycle = plt.rcParams[\PYGZsq{}axes.prop\PYGZus{}cycle\PYGZsq{}].by\PYGZus{}key()[\PYGZsq{}color\PYGZsq{}]}
\PYG{c+c1}{\PYGZsh{} fig, ax = plt.subplots(figsize=(5,4))}
\PYG{c+c1}{\PYGZsh{} ax.step(decimate(t,conf.decimation*16),decimate(outputs,conf.decimation*16),label=\PYGZdq{}true\PYGZdq{})}
\PYG{c+c1}{\PYGZsh{} ax.plot(decimate(t,conf.decimation),decimate(out\PYGZus{}mdof[0,:],1),\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZdq{},label=f\PYGZdq{}prediction\PYGZdq{})}
\PYG{c+c1}{\PYGZsh{} ax.set\PYGZus{}xlabel(\PYGZdq{}Time (s)\PYGZdq{})\PYGZsh{} , fontsize=13)}
\PYG{c+c1}{\PYGZsh{} ax.set\PYGZus{}ylabel(\PYGZdq{}Output\PYGZdq{})\PYGZsh{} , fontsize=13)}
\PYG{c+c1}{\PYGZsh{} ax.set\PYGZus{}xlim((25,45))}
\PYG{c+c1}{\PYGZsh{} plt.tick\PYGZus{}params(left = False, right = False , labelleft = False ,}
\PYG{c+c1}{\PYGZsh{}                 labelbottom = False, bottom = False);}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=776\sphinxpxdimen,height=409\sphinxpxdimen]{{examples_02_SISO_Event_23_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\section{SISO for Event History}
\label{\detokenize{examples/03_SISO_History:SISO-for-Event-History}}\label{\detokenize{examples/03_SISO_History::doc}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{k+kn}{import} \PYG{n+nn}{mdof}
\PYG{k+kn}{from} \PYG{n+nn}{mdof} \PYG{k+kn}{import} \PYG{n}{modal}\PYG{p}{,} \PYG{n}{transform}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{config} \PYG{k+kn}{import} \PYG{n}{Config}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Upload a Dataset and Identify Spectral Quantities}
\label{\detokenize{examples/03_SISO_History:Upload-a-Dataset-and-Identify-Spectral-Quantities}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{inputs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./uploads/opensees\PYGZus{}sdof/Accgrd\PYGZus{}set1.csv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{delimiter}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{outputs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{loadtxt}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./uploads/opensees\PYGZus{}sdof/Accrsp\PYGZus{}set1.csv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{delimiter}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} inputs = np.loadtxt(\PYGZdq{}./uploads/opensees\PYGZus{}sdof/Accgrd\PYGZus{}set2.csv\PYGZdq{}, delimiter=\PYGZdq{},\PYGZdq{})}
\PYG{c+c1}{\PYGZsh{} outputs = np.loadtxt(\PYGZdq{}./uploads/opensees\PYGZus{}sdof/Accrsp\PYGZus{}set2.csv\PYGZdq{}, delimiter=\PYGZdq{},\PYGZdq{})}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{inputs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}
\PYG{n}{dt} \PYG{o}{=} \PYG{n}{t}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{t}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Method Inputs}
\label{\detokenize{examples/03_SISO_History:Method-Inputs}}
\sphinxAtStartPar
See \sphinxcode{\sphinxupquote{\textasciigrave{}01\_SISO\_Intro}} \textless{}./01\_SISO\_Intro.ipynb\textgreater{}\textasciigrave{}\_\_ for parameter definitions

\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Set parameters}
\PYG{n}{conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{m}  \PYG{o}{=} \PYG{l+m+mi}{300}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{horizon} \PYG{o}{=} \PYG{l+m+mi}{140}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{nc} \PYG{o}{=} \PYG{l+m+mi}{140}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{order}  \PYG{o}{=}   \PYG{l+m+mi}{2}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{a}  \PYG{o}{=}   \PYG{l+m+mi}{0}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{b}  \PYG{o}{=}   \PYG{l+m+mi}{0}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{l}  \PYG{o}{=}  \PYG{l+m+mi}{10}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{g}  \PYG{o}{=}   \PYG{l+m+mi}{3}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{damping} \PYG{o}{=} \PYG{l+m+mf}{0.0001}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{3.0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Perform System Identification}
\label{\detokenize{examples/03_SISO_History:Perform-System-Identification}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{mode\PYGZus{}predictions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i}\PYG{p}{,}\PYG{n}{motion} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{8}         \PYG{c+c1}{\PYGZsh{} transfer function decimation}
    \PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{,}\PYG{n}{C}\PYG{p}{,}\PYG{n}{D} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{system}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{srim}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{motion}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{n}{ss\PYGZus{}modes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{system\PYGZus{}modes}\PYG{p}{(}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{,}\PYG{n}{C}\PYG{p}{,}\PYG{n}{D}\PYG{p}{)}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{,}\PYG{n}{decimation}\PYG{o}{=}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}
    \PYG{n}{mode\PYGZus{}predictions}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{v}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{v}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{damp}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{]} \PYG{k}{for} \PYG{n}{v} \PYG{o+ow}{in} \PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}  \PYG{c+c1}{\PYGZsh{} save predicted period and damping}
    \PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{1}         \PYG{c+c1}{\PYGZsh{} transfer function decimation}
    \PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{motion}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{step}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{blue}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{l+m+mi}{0} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{response\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{motion}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{step}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{threads}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{green}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Response Spectrum}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{l+m+mi}{0} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{v}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{k}{for} \PYG{n}{v} \PYG{o+ow}{in} \PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{,} \PYG{n}{colors}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{State Space}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{l+m+mi}{0} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Period (s)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Amplitude}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{   period(s)  damping}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{mode\PYGZus{}predictions}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 885/886 [00:00<00:00, 43449.79it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 140370.56it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 524584.38it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 105184.44it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 29318.75it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 120463.39it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 26359.04it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 16509.04it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 21930.00it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 22432.14it/s]
100\%|█████████▉| 885/886 [00:00<00:00, 18971.38it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
   period(s)  damping
 [[0.41068031 0.02342356]
 [0.41083068 0.02249289]
 [0.4107063  0.00068529]
 [0.41201371 0.02015356]
 [0.41051848 0.02368659]
 [0.4112227  0.02544649]
 [0.40933146 0.01991049]
 [0.41281326 0.0191038 ]
 [0.40928958 0.02311352]
 [0.41883737 0.0023086 ]
 [0.40943662 0.02034821]]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=681\sphinxpxdimen,height=370\sphinxpxdimen]{{examples_03_SISO_History_7_2}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\section{Introduction to MIMO}
\label{\detokenize{examples/04_MIMO_Intro:Introduction-to-MIMO}}\label{\detokenize{examples/04_MIMO_Intro::doc}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{mdof}
\PYG{k+kn}{from} \PYG{n+nn}{mdof} \PYG{k+kn}{import} \PYG{n}{modal}\PYG{p}{,} \PYG{n}{transform}
\PYG{k+kn}{import} \PYG{n+nn}{sdof}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{numpy} \PYG{k+kn}{import} \PYG{n}{linspace}\PYG{p}{,} \PYG{n}{sqrt}\PYG{p}{,} \PYG{n}{pi}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{config} \PYG{k+kn}{import} \PYG{n}{Config}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities}\PYG{n+nn}{.}\PYG{n+nn}{printing} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{numerics} \PYG{k+kn}{import} \PYG{n}{decimate}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Unknown multi\sphinxhyphen{}input, multi\sphinxhyphen{}output system}
\label{\detokenize{examples/04_MIMO_Intro:Unknown-multi-input,-multi-output-system}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\(m_{1}\)
&
\sphinxAtStartPar
mass at dof 1
\\
\sphinxhline
\sphinxAtStartPar
\(m_{2}\)
&
\sphinxAtStartPar
mass at dof 2
\\
\sphinxhline
\sphinxAtStartPar
\(k_{1}\)
&
\sphinxAtStartPar
stiffness at dof 1
\\
\sphinxhline
\sphinxAtStartPar
\(k_{2}\)
&
\sphinxAtStartPar
stiffness at dof 2
\\
\sphinxhline
\sphinxAtStartPar
\(\omega_{1}\)
&
\sphinxAtStartPar
natural periods for mode 1
\\
\sphinxhline
\sphinxAtStartPar
\(\omega_{2}\)
&
\sphinxAtStartPar
natural periods for mode 2
\\
\sphinxhline
\sphinxAtStartPar
\(\zeta_{1}\)
&
\sphinxAtStartPar
modal damping for mode 1
\\
\sphinxhline
\sphinxAtStartPar
\(\zeta_{2}\)
&
\sphinxAtStartPar
modal damping for mode 2
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxincludegraphics[width=3699\sphinxpxdimen,height=1192\sphinxpxdimen]{{2dof}.png}
\begin{equation*}
\begin{split}a = \frac{m_{1}}{m_{2}}\end{split}
\end{equation*}\begin{equation*}
\begin{split}b = \frac{k_{1}}{k_{2}}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{M} = \begin{bmatrix} m_{1} & 0 \\ 0 & m_{2} \end{bmatrix} = m_{2}\begin{bmatrix} a & 0 \\ 0 & 1 \end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{K} = \begin{bmatrix} k_{1}+k_{2} & -k_{2} \\ -k_{2} & k_{2} \end{bmatrix} = k_{2} \begin{bmatrix} 1+b & -1 \\ -1 & 1 \end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{M}^{-1}\mathbf{K} = \frac{k_{2}}{am_{2}}\begin{bmatrix} 1+b & -1 \\ -a & a \end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}(1+b-\lambda)(a-\lambda)+a = 0\end{split}
\end{equation*}\begin{equation*}
\begin{split}\lambda^{2}+(-b-a{m}-1)\lambda+2a+ab = 0\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{M\ddot{u}} + \mathbf{Ku} = \mathbf{f(t)}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{\ddot{u}}  + \mathbf{M^{-1}Ku} = \mathbf{M^{-1}f(t)}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{u} =  \Phi \mathbf{q}, \hspace{1cm} \mathbf{M^{-1}K} = \Phi\Lambda\Phi^{-1}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{\ddot{u}}  + \mathbf{M^{-1}Ku} = \mathbf{M^{-1}f(t)}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{\ddot{u}}  + \Phi\Lambda\Phi^{-1}\mathbf{u} = \mathbf{M^{-1}f(t)}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\Phi^{-1}\mathbf{\ddot{u}}  + \Phi^{-1}\Phi\Lambda\Phi^{-1}\mathbf{u} = \Phi^{-1}\mathbf{M^{-1}f(t)}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{\ddot{q}}  + \Lambda\mathbf{q} = \Phi^{-1}\mathbf{M^{-1}f(t)}\end{split}
\end{equation*}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} get modal coordinates}
\PYG{k}{def} \PYG{n+nf}{diag2dof}\PYG{p}{(}\PYG{n}{m1}\PYG{p}{,} \PYG{n}{m2}\PYG{p}{,} \PYG{n}{k1}\PYG{p}{,} \PYG{n}{k2}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{m} \PYG{o}{=} \PYG{n}{m2}
  \PYG{n}{k} \PYG{o}{=} \PYG{n}{k2}
  \PYG{n}{a} \PYG{o}{=} \PYG{n}{m1}\PYG{o}{/}\PYG{n}{m2}
  \PYG{n}{b} \PYG{o}{=} \PYG{n}{k1}\PYG{o}{/}\PYG{n}{k2}
  \PYG{n}{kab1} \PYG{o}{=} \PYG{n}{k}\PYG{o}{*}\PYG{p}{(}\PYG{n}{a} \PYG{o}{+} \PYG{n}{b} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{a}\PYG{o}{*}\PYG{n}{m}\PYG{p}{)}
  \PYG{n}{ksqr} \PYG{o}{=} \PYG{n}{k}\PYG{o}{*}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{a}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{a}\PYG{o}{*}\PYG{n}{b} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{a} \PYG{o}{+} \PYG{n}{b}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{b} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{a}\PYG{o}{*}\PYG{n}{m}\PYG{p}{)}
  \PYG{n}{eigvals} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{kab1} \PYG{o}{\PYGZhy{}} \PYG{n}{ksqr}\PYG{p}{,}  \PYG{n}{kab1} \PYG{o}{+} \PYG{n}{ksqr}\PYG{p}{]}\PYG{p}{)}
  \PYG{n}{eigvecs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{m}\PYG{o}{*}\PYG{p}{(}\PYG{n}{kab1} \PYG{o}{\PYGZhy{}} \PYG{n}{ksqr}\PYG{p}{)}\PYG{o}{/}\PYG{n}{k}\PYG{p}{,}   \PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{m}\PYG{o}{*}\PYG{p}{(}\PYG{n}{kab1} \PYG{o}{+} \PYG{n}{ksqr}\PYG{p}{)}\PYG{o}{/}\PYG{n}{k}\PYG{p}{]}\PYG{p}{,}
                      \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
  \PYG{k}{return} \PYG{n}{eigvals}\PYG{p}{,} \PYG{n}{eigvecs}

\PYG{c+c1}{\PYGZsh{} displacement response (analytical solution) (output)}
\PYG{k}{def} \PYG{n+nf}{harmonic\PYGZus{}sdof}\PYG{p}{(}\PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{,} \PYG{n}{nt}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{k}\PYG{p}{,} \PYG{n}{omega\PYGZus{}n}\PYG{p}{,} \PYG{n}{zeta}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{omega\PYGZus{}D} \PYG{o}{=} \PYG{n}{omega\PYGZus{}n}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{zeta}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
  \PYG{n}{output} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{)}\PYG{p}{,}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{)}
  \PYG{k}{for} \PYG{n}{i}\PYG{p}{,}\PYG{n}{omega} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{C3} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{k}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
    \PYG{n}{C4} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
    \PYG{n}{C1} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{C4}
    \PYG{n}{C2} \PYG{o}{=} \PYG{p}{(}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{o}{*}\PYG{n}{C1}\PYG{o}{\PYGZhy{}}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{C3}\PYG{p}{)}\PYG{o}{/}\PYG{n}{omega\PYGZus{}D}
    \PYG{n}{output}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{C1}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{omega\PYGZus{}D}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}\PYG{o}{+}\PYG{n}{C2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{omega\PYGZus{}D}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{C3}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)} \PYG{o}{+} \PYG{n}{C4}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{t}\PYG{p}{)}
  \PYG{n}{output} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{output}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
  \PYG{k}{return} \PYG{n}{output}

\PYG{k}{def} \PYG{n+nf}{harmonic\PYGZus{}2dof}\PYG{p}{(}\PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{,} \PYG{n}{nt}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{m1}\PYG{p}{,} \PYG{n}{m2}\PYG{p}{,} \PYG{n}{k1}\PYG{p}{,} \PYG{n}{k2}\PYG{p}{,} \PYG{n}{zeta1}\PYG{p}{,} \PYG{n}{zeta2}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{ks} \PYG{o}{=} \PYG{p}{[}\PYG{n}{k1}\PYG{p}{,} \PYG{n}{k2}\PYG{p}{]}
  \PYG{n}{zs} \PYG{o}{=} \PYG{p}{[}\PYG{n}{zeta1}\PYG{p}{,} \PYG{n}{zeta2}\PYG{p}{]}
  \PYG{n}{omega\PYGZus{}ns}\PYG{p}{,} \PYG{n}{phis} \PYG{o}{=} \PYG{n}{diag2dof}\PYG{p}{(}\PYG{n}{m1}\PYG{p}{,} \PYG{n}{m2}\PYG{p}{,} \PYG{n}{k1}\PYG{p}{,} \PYG{n}{k2}\PYG{p}{)}
  \PYG{n}{outputs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{)}
  \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{outputs}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{harmonic\PYGZus{}sdof}\PYG{p}{(}\PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{,} \PYG{n}{nt}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{ks}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{omega\PYGZus{}ns}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{zs}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
  \PYG{n}{outputs} \PYG{o}{=} \PYG{n}{phis}\PYG{n+nd}{@outputs}
  \PYG{k}{return} \PYG{n}{omega\PYGZus{}ns}\PYG{p}{,} \PYG{n}{phis}\PYG{p}{,} \PYG{n}{outputs}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} parameters of 2DOF system}
\PYG{n}{m1} \PYG{o}{=} \PYG{l+m+mi}{2}          \PYG{c+c1}{\PYGZsh{} mass}
\PYG{n}{m2} \PYG{o}{=} \PYG{l+m+mi}{1}          \PYG{c+c1}{\PYGZsh{} mass}
\PYG{n}{ms} \PYG{o}{=} \PYG{p}{[}\PYG{n}{m1}\PYG{p}{,} \PYG{n}{m2}\PYG{p}{]}
\PYG{n}{k1} \PYG{o}{=} \PYG{l+m+mi}{30}         \PYG{c+c1}{\PYGZsh{} stiffness}
\PYG{n}{k2} \PYG{o}{=} \PYG{l+m+mi}{10}         \PYG{c+c1}{\PYGZsh{} stiffness}
\PYG{n}{ks} \PYG{o}{=} \PYG{p}{[}\PYG{n}{k1}\PYG{p}{,} \PYG{n}{k2}\PYG{p}{]}
\PYG{n}{zeta1} \PYG{o}{=} \PYG{l+m+mf}{0.01}    \PYG{c+c1}{\PYGZsh{} damping ratio}
\PYG{n}{zeta2} \PYG{o}{=} \PYG{l+m+mf}{0.02}    \PYG{c+c1}{\PYGZsh{} damping ratio}
\PYG{n}{zetas} \PYG{o}{=} \PYG{p}{[}\PYG{n}{zeta1}\PYG{p}{,} \PYG{n}{zeta2}\PYG{p}{]}

\PYG{n}{omega\PYGZus{}ns}\PYG{p}{,} \PYG{n}{phis} \PYG{o}{=} \PYG{n}{diag2dof}\PYG{p}{(}\PYG{o}{*}\PYG{n}{ms}\PYG{p}{,} \PYG{o}{*}\PYG{n}{ks}\PYG{p}{)}

\PYG{n}{C} \PYG{o}{=} \PYG{n}{phis} \PYG{o}{@} \PYG{n}{np}\PYG{o}{.}\PYG{n}{diag}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{zeta}\PYG{o}{*}\PYG{n}{omega\PYGZus{}n} \PYG{k}{for} \PYG{n}{zeta}\PYG{p}{,}\PYG{n}{omega\PYGZus{}n} \PYG{o+ow}{in} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{zetas}\PYG{p}{,} \PYG{n}{omega\PYGZus{}ns}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}   \PYG{c+c1}{\PYGZsh{} damping coefficients}

\PYG{n}{Tns} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{n}{omega\PYGZus{}n} \PYG{k}{for} \PYG{n}{omega\PYGZus{}n} \PYG{o+ow}{in} \PYG{n}{omega\PYGZus{}ns}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{natural periods: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Tns}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s2}{\PYGZlt{}3.3}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{s, }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Tns}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s2}{\PYGZlt{}3.3}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{damping ratios: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{zeta1}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{, }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{zeta2}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} print(f\PYGZdq{}damping matrix: \PYGZob{}C\PYGZcb{}\PYGZdq{})}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
natural periods: 0.991s, 0.266s
damping ratios: 0.01, 0.02
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} forcing function (input)}
\PYG{n}{nt} \PYG{o}{=} \PYG{l+m+mi}{2000}       \PYG{c+c1}{\PYGZsh{} number of timesteps}
\PYG{n}{dt} \PYG{o}{=} \PYG{l+m+mf}{0.03}       \PYG{c+c1}{\PYGZsh{} timestep}
\PYG{n}{tf} \PYG{o}{=} \PYG{n}{nt}\PYG{o}{*}\PYG{n}{dt}      \PYG{c+c1}{\PYGZsh{} final time}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n}{start} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{stop} \PYG{o}{=} \PYG{n}{tf}\PYG{p}{,} \PYG{n}{step} \PYG{o}{=} \PYG{n}{dt}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} times}
\PYG{n}{forcing\PYGZus{}frequencies} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{n}{omega\PYGZus{}ns}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]} \PYG{c+c1}{\PYGZsh{} [0.017*omega\PYGZus{}ns[0], 0.14*omega\PYGZus{}ns[0], 0.467*omega\PYGZus{}ns[0], 0.186*omega\PYGZus{}ns[0], 0.2937*omega\PYGZus{}ns[0]]  \PYGZsh{} forcing frequencies (rad/s)}
\PYG{n}{inputs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{p}{[}\PYG{n}{omega}\PYG{o}{*}\PYG{n}{t} \PYG{k}{for} \PYG{n}{omega} \PYG{o+ow}{in} \PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} displacement response (output)}
\PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{\PYGZus{}}\PYG{p}{,} \PYG{n}{outputs} \PYG{o}{=} \PYG{n}{harmonic\PYGZus{}2dof}\PYG{p}{(}\PYG{n}{forcing\PYGZus{}frequencies}\PYG{p}{,} \PYG{n}{nt}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{o}{*}\PYG{n}{ms}\PYG{p}{,} \PYG{o}{*}\PYG{n}{ks}\PYG{p}{,} \PYG{o}{*}\PYG{n}{zetas}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} plot input vs. output}
\PYG{n}{plot\PYGZus{}io}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2DOF Displacement Response to Sinusoidal Forcing}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=801\sphinxpxdimen,height=301\sphinxpxdimen]{{examples_04_MIMO_Intro_10_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Configure}
\label{\detokenize{examples/04_MIMO_Intro:Configure}}

\subsubsection{Method}
\label{\detokenize{examples/04_MIMO_Intro:Method}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{order} \PYG{o}{=} \PYG{l+m+mi}{4}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{horizon} \PYG{o}{=} \PYG{l+m+mi}{1000}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Analysis with System Identification}
\label{\detokenize{examples/04_MIMO_Intro:Analysis-with-System-Identification}}

\subsubsection{Modal Estimation}
\label{\detokenize{examples/04_MIMO_Intro:Modal-Estimation}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Set parameters}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{damping} \PYG{o}{=} \PYG{n}{zetas}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Period band (s)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{pseudo} \PYG{o}{=} \PYG{k+kc}{False} \PYG{c+c1}{\PYGZsh{} use pseudo accelerations (Sa)}

\PYG{c+c1}{\PYGZsh{} A place to store models and their predictions}
\PYG{n}{transfer\PYGZus{}models} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Generate a transfer function representation of the system}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier Transform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} transfer\PYGZus{}models[\PYGZdq{}Response Spectrum\PYGZdq{}] = transform.response\PYGZus{}transfer(inputs, outputs[0], dt, **conf)}

\PYG{c+c1}{\PYGZsh{} Determing the fundamental frequency}
\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{,} \PYG{n}{fourier\PYGZus{}amplitudes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{spectrum\PYGZus{}modes}\PYG{p}{(}\PYG{o}{*}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fourier Transform}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} response\PYGZus{}periods, response\PYGZus{}amplitudes = modal.spectrum\PYGZus{}modes(*transfer\PYGZus{}models[\PYGZdq{}Response Spectrum\PYGZdq{}],height=0.15)}

\PYG{c+c1}{\PYGZsh{} Generate a state space realization of the system}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{realization} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{system}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{srim}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Obtain natural period and damping ratio from the state space model}
\PYG{n}{ss\PYGZus{}modes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{system\PYGZus{}modes}\PYG{p}{(}\PYG{n}{realization}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{ss\PYGZus{}periods} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{f} \PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{p}{[}\PYG{n}{ss\PYGZus{}modes}\PYG{p}{[}\PYG{n}{mode}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{k}{for} \PYG{n}{mode} \PYG{o+ow}{in} \PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ss\PYGZus{}periods}\PYG{p}{)}

\PYG{n}{plot\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{transfer\PYGZus{}models}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Transfer Functions}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{color\PYGZus{}cycle} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{rcParams}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{axes.prop\PYGZus{}cycle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{by\PYGZus{}key}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{n}{ss\PYGZus{}periods}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{colors}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{label}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{State Space}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plt.gcf().axes[0].vlines([*fourier\PYGZus{}periods[:2], *response\PYGZus{}periods[:2]],ymin=0,ymax=1,linestyles=\PYGZsq{}\PYGZhy{}\PYGZhy{}\PYGZsq{},colors=[color\PYGZus{}cycle[0],color\PYGZus{}cycle[0],color\PYGZus{}cycle[1],color\PYGZus{}cycle[1]])}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{p}{[}\PYG{o}{*}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}\PYG{n}{ymin}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{ymax}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{colors}\PYG{o}{=}\PYG{n}{color\PYGZus{}cycle}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mf}{0.05}\PYG{p}{,}\PYG{l+m+mf}{0.975}\PYG{p}{,}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}T\PYGZus{}}\PYG{l+s+si}{\PYGZob{}fourier\PYGZcb{}}\PYG{l+s+s2}{\PYGZdl{} = }\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{fourier\PYGZus{}periods}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{n}{ss\PYGZus{}periods}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{+}\PYG{l+m+mf}{0.05}\PYG{p}{,}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}T\PYGZus{}}\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{state space\PYGZcb{}\PYGZdl{} = }\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{ss\PYGZus{}periods}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} plt.gcf().axes[0].text(response\PYGZus{}periods[i]+0.05,0.875,r\PYGZdq{}\PYGZdl{}T\PYGZus{}\PYGZob{}response\PYGZcb{}\PYGZdl{} = \PYGZdq{}+str(np.round(response\PYGZus{}periods[i],3)),fontsize=15)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}figwidth}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gcf}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylim}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mf}{1.1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 1200/1201 [00:00<00:00, 15390.62it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
[0.9910784035648029, 0.2655586578710922]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=853\sphinxpxdimen,height=316\sphinxpxdimen]{{examples_04_MIMO_Intro_16_2}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Response Prediction}
\label{\detokenize{examples/04_MIMO_Intro:Response-Prediction}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[16]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Reproduce the response with the state space model}
\PYG{k+kn}{from} \PYG{n+nn}{control} \PYG{k+kn}{import} \PYG{n}{ss}\PYG{p}{,} \PYG{n}{forced\PYGZus{}response}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{horizon} \PYG{o}{=} \PYG{l+m+mi}{800}
\PYG{n}{realization} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{system}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{okid\PYGZhy{}era\PYGZhy{}dc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outputs}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
\PYG{n}{out\PYGZus{}pred} \PYG{o}{=} \PYG{n}{forced\PYGZus{}response}\PYG{p}{(}\PYG{n}{ss}\PYG{p}{(}\PYG{o}{*}\PYG{n}{realization}\PYG{p}{,}\PYG{n}{dt}\PYG{o}{*}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{U}\PYG{o}{=}\PYG{n}{decimate}\PYG{p}{(}\PYG{n}{inputs}\PYG{p}{,}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{squeeze}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{return\PYGZus{}x}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{o}{.}\PYG{n}{outputs}
\PYG{n}{plot\PYGZus{}pred}\PYG{p}{(}\PYG{n}{ytrue}\PYG{o}{=}\PYG{n}{decimate}\PYG{p}{(}\PYG{n}{outputs}\PYG{p}{,}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{models}\PYG{o}{=}\PYG{n}{out\PYGZus{}pred}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{decimate}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation}\PYG{p}{)}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{State Space Model Displacement Response}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=776\sphinxpxdimen,height=409\sphinxpxdimen]{{examples_04_MIMO_Intro_18_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\section{MIMO for a Ground Motion Event}
\label{\detokenize{examples/05_MIMO_Event:MIMO-for-a-Ground-Motion-Event}}\label{\detokenize{examples/05_MIMO_Event::doc}}

\subsection{Chopra Section 9.7}
\label{\detokenize{examples/05_MIMO_Event:Chopra-Section-9.7}}
\sphinxAtStartPar
\sphinxincludegraphics[width=1058\sphinxpxdimen,height=1240\sphinxpxdimen]{{ex9.10}.png}


\subsubsection{Partitioned equation of dynamic equilibrium (Chopra Eq. 9.7.1)}
\label{\detokenize{examples/05_MIMO_Event:Partitioned-equation-of-dynamic-equilibrium-(Chopra-Eq.-9.7.1)}}\begin{equation*}
\begin{split}\begin{bmatrix}
\mathbf{m} & \mathbf{m}_g \\
\mathbf{m}^T_g & \mathbf{m}_{gg}
\end{bmatrix}
\begin{Bmatrix}
\mathbf{\ddot{u}}^t \\
\mathbf{\ddot{u}}_g
\end{Bmatrix}
+
\begin{bmatrix}
\mathbf{c} & \mathbf{c}_g \\
\mathbf{c}^T_g & \mathbf{c}_{gg}
\end{bmatrix}
\begin{Bmatrix}
\mathbf{\dot{u}}^t \\
\mathbf{\dot{u}}_g
\end{Bmatrix}
+
\begin{bmatrix}
\mathbf{k} & \mathbf{k}_g \\
\mathbf{k}^T_g & \mathbf{k}_{gg}
\end{bmatrix}
\begin{Bmatrix}
\mathbf{u}^t \\
\mathbf{u}_g
\end{Bmatrix}
=
\begin{Bmatrix}
\mathbf{0} \\
\mathbf{p}_g(t)
\end{Bmatrix}\end{split}
\end{equation*}

\subsubsection{Problem Statement}
\label{\detokenize{examples/05_MIMO_Event:Problem-Statement}}
\sphinxAtStartPar
given: \(\mathbf{u}_g\), \(\mathbf{\dot{u}}_g\), and \(\mathbf{\ddot{u}}_g\)

\sphinxAtStartPar
find: \(\mathbf{u}^t\) and \(\mathbf{p}_g(t)\)

\sphinxAtStartPar
\textendash{}\textgreater{} (system ID: given output \(\mathbf{u}^t\) and input \(\mathbf{\ddot{u}}_g\), determine fundamental frequencies and mode shapes of the structure.)


\subsubsection{General equation of motion for multiple support excitation}
\label{\detokenize{examples/05_MIMO_Event:General-equation-of-motion-for-multiple-support-excitation}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
split displacements into quasi\sphinxhyphen{}static (\(\mathbf{u}^s\)) and dynamic (\(\mathbf{u}\)) displacements (chopra eq 9.7.2):

\end{enumerate}
\begin{equation*}
\begin{split}\begin{Bmatrix}
\mathbf{u}^t \\
\mathbf{u}_g
\end{Bmatrix}
=
\begin{Bmatrix}
\mathbf{u}^s \\
\mathbf{u}_g
\end{Bmatrix}
+
\begin{Bmatrix}
\mathbf{u} \\
\mathbf{0}
\end{Bmatrix}\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
\sphinxAtStartPar
take the first half of the partitioned equilibrium equation from eq 9.7.1 (chopra eq 9.7.4)

\end{enumerate}
\begin{equation*}
\begin{split}\mathbf{m}\mathbf{\ddot{u}}^t + \mathbf{m}_g\mathbf{\ddot{u}}_g
+
\mathbf{c}\mathbf{\dot{u}}^t + \mathbf{c}_g\mathbf{\dot{u}}_g
+
\mathbf{k}\mathbf{u}^t + \mathbf{k}_g\mathbf{u}_g
=
\mathbf{0}\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
substitute eq 9.7.2 (\(\mathbf{u}^t=\mathbf{u}^s+\mathbf{u}\)) and move all \(\mathbf{u}_g\) and \(\mathbf{u}^s\) terms to the right side (chopra eq 9.7.5):
\begin{equation*}
\begin{split}\mathbf{m}\mathbf{\ddot{u}} + \mathbf{c}\mathbf{\dot{u}} + \mathbf{k}\mathbf{u}
= \mathbf{p}_{eff}(t)\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}\mathbf{p}_{eff}(t) =
-(\mathbf{m}\mathbf{\ddot{u}}^s+\mathbf{m}_g\mathbf{\ddot{u}}_g)
-(\mathbf{c}\mathbf{\dot{u}}^s+\mathbf{c}_g\mathbf{\dot{u}}_g)
-(\mathbf{k}\mathbf{u}^s+\mathbf{k}_g\mathbf{u}_g)\end{split}
\end{equation*}
\sphinxAtStartPar
which simplifies to
\begin{equation*}
\begin{split}\mathbf{p}_{eff}(t) =
-\mathbf{m}\mathbf{\iota}\mathbf{\ddot{u}}_g(t)\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
final equation of motion
\begin{equation*}
\begin{split}\mathbf{m}\mathbf{\ddot{u}} + \mathbf{c}\mathbf{\dot{u}} + \mathbf{k}\mathbf{u}
= -\mathbf{m}\mathbf{\iota}\mathbf{\ddot{u}}_g(t)\end{split}
\end{equation*}
\end{enumerate}


\subsubsection{Example 9.10}
\label{\detokenize{examples/05_MIMO_Event:Example-9.10}}
\sphinxAtStartPar
\sphinxincludegraphics[width=1058\sphinxpxdimen,height=1240\sphinxpxdimen]{{ex9.10}.png}

\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{matplotlib} \PYG{k+kn}{import} \PYG{n}{pyplot} \PYG{k}{as} \PYG{n}{plt}

\PYG{c+c1}{\PYGZsh{} EI/L\PYGZca{}3 = 1}
\PYG{n}{EIL3} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{c+c1}{\PYGZsh{} m = 1}
\PYG{n}{m\PYGZus{}node} \PYG{o}{=} \PYG{l+m+mi}{1}

\PYG{n}{k\PYGZus{}hat} \PYG{o}{=} \PYG{n}{EIL3}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}
    \PYG{p}{[}
        \PYG{p}{[}\PYG{l+m+mf}{78.86}\PYG{p}{,} \PYG{l+m+mf}{30.86}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{29.14}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{75.43}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.14}\PYG{p}{]}\PYG{p}{,}
        \PYG{p}{[}\PYG{l+m+mf}{30.86}\PYG{p}{,} \PYG{l+m+mf}{78.86}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.13}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{75.43}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{29.14}\PYG{p}{]}\PYG{p}{,}
        \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{29.14}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.14}\PYG{p}{,} \PYG{l+m+mf}{12.86}\PYG{p}{,} \PYG{l+m+mf}{20.57}\PYG{p}{,} \PYG{l+m+mf}{0.86}\PYG{p}{]}\PYG{p}{,}
        \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{75.43}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{75.43}\PYG{p}{,} \PYG{l+m+mf}{20.57}\PYG{p}{,} \PYG{l+m+mf}{109.71}\PYG{p}{,} \PYG{l+m+mf}{20.57}\PYG{p}{]}\PYG{p}{,}
        \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.14}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{29.14}\PYG{p}{,} \PYG{l+m+mf}{0.86}\PYG{p}{,} \PYG{l+m+mf}{20.57}\PYG{p}{,} \PYG{l+m+mf}{12.86}\PYG{p}{]}
    \PYG{p}{]}
\PYG{p}{)}

\PYG{n}{k} \PYG{o}{=} \PYG{n}{k\PYGZus{}hat}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{k\PYGZus{}g} \PYG{o}{=} \PYG{n}{k\PYGZus{}hat}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{p}{]}
\PYG{n}{k\PYGZus{}gg} \PYG{o}{=} \PYG{n}{k\PYGZus{}hat}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{p}{]}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{k}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{, }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{k\PYGZus{}g}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{, }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{k\PYGZus{}gg}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{m} \PYG{o}{=} \PYG{n}{m\PYGZus{}node}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{identity}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{m}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{iota} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{n}{k}\PYG{p}{)}\PYG{n+nd}{@k\PYGZus{}g}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{iota}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
k=array([[78.86, 30.86],
       [30.86, 78.86]]),
k\_g=array([[-29.14, -75.43,  -5.14],
       [ -5.13, -75.43, -29.14]]),
k\_gg=array([[ 12.86,  20.57,   0.86],
       [ 20.57, 109.71,  20.57],
       [  0.86,  20.57,  12.86]])
m=array([[1., 0.],
       [0., 1.]])
iota=array([[ 0.40627442,  0.68747721, -0.09378418],
       [-0.09393392,  0.68747721,  0.40621582]])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Equation of motion for chopra example 9.10}
\label{\detokenize{examples/05_MIMO_Event:Equation-of-motion-for-chopra-example-9.10}}\begin{equation*}
\begin{split}\mathbf{m}\mathbf{\ddot{u}} + \mathbf{k}\mathbf{u}
= -\sum_{l=1}^{3}\mathbf{m}\mathbf{\iota}_l\mathbf{\ddot{u}}_{gl}(t)\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}m = m\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}k = \frac{EI}{L^3}\begin{bmatrix}
78.86 & 30.86 \\
30.86 & 78.86
\end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\iota_1 = \begin{Bmatrix}0.40625\\-0.09375\end{Bmatrix}
\iota_2 = \begin{Bmatrix}0.68750\\0.68750\end{Bmatrix}
\iota_1 = \begin{Bmatrix}-0.09375\\0.40625\end{Bmatrix}\end{split}
\end{equation*}

\subsubsection{Plot example input and output motions for chopra example 9.10}
\label{\detokenize{examples/05_MIMO_Event:Plot-example-input-and-output-motions-for-chopra-example-9.10}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{matplotlib} \PYG{k+kn}{import} \PYG{n}{pyplot} \PYG{k}{as} \PYG{n}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{scipy} \PYG{k+kn}{import} \PYG{n}{integrate}
\PYG{k+kn}{from} \PYG{n+nn}{numpy} \PYG{k+kn}{import} \PYG{n}{pi}
\PYG{n}{tf} \PYG{o}{=} \PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{pi}
\PYG{n}{dt} \PYG{o}{=} \PYG{l+m+mf}{0.01}
\PYG{n}{ns} \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{n}{nf} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{n}{tf}\PYG{p}{,} \PYG{l+m+mi}{1000}\PYG{p}{)}
\PYG{n+nb}{input} \PYG{o}{=} \PYG{p}{[}
    \PYG{k}{lambda} \PYG{n}{t}\PYG{p}{:} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n}{t} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{p}{,}
    \PYG{k}{lambda} \PYG{n}{t}\PYG{p}{:} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n}{t} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pi}\PYG{p}{)}\PYG{p}{,}
    \PYG{k}{lambda} \PYG{n}{t}\PYG{p}{:} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n}{t} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} lambda t: np.sin(t),}
    \PYG{c+c1}{\PYGZsh{} lambda t: np.sin(t),}
    \PYG{c+c1}{\PYGZsh{} lambda t: np.sin(t\PYGZhy{}0.1)}
\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} input = np.sin(t) + 20*np.random.rand(nt)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{input}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{support 1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{support 2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{support 3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{minvk} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{n+nd}{@k}
\PYG{k}{def} \PYG{n+nf}{ex910}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{minvk}\PYG{p}{,}\PYG{n}{iota}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{dydt} \PYG{o}{=} \PYG{n}{y}
    \PYG{n}{mipeff} \PYG{o}{=} \PYG{n+nb}{sum}\PYG{p}{(}\PYG{n+nb}{input}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{(}\PYG{n}{t}\PYG{p}{)}\PYG{o}{*}\PYG{n}{iota}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{ns}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}
        \PYG{o}{*}\PYG{n}{y}\PYG{p}{[}\PYG{n}{nf}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,}
        \PYG{o}{*}\PYG{p}{(}\PYG{n}{mipeff} \PYG{o}{\PYGZhy{}} \PYG{n}{minvk}\PYG{n+nd}{@y}\PYG{p}{[}\PYG{p}{:}\PYG{n}{nf}\PYG{p}{]}\PYG{p}{)}
    \PYG{p}{]}\PYG{p}{)}
\PYG{n}{output} \PYG{o}{=} \PYG{n}{integrate}\PYG{o}{.}\PYG{n}{odeint}\PYG{p}{(}\PYG{n}{ex910}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{args}\PYG{o}{=}\PYG{p}{(}\PYG{n}{minvk}\PYG{p}{,}\PYG{n}{iota}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{n}{output}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{output}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dof 1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{dof 2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=874\sphinxpxdimen,height=319\sphinxpxdimen]{{examples_05_MIMO_Event_8_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{scipy}
\PYG{n}{D}\PYG{p}{,} \PYG{n}{V} \PYG{o}{=} \PYG{n}{scipy}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,} \PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{V}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{, }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{D}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{D}\PYG{p}{,} \PYG{n}{V} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{minvk}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{V}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{, }\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{D}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{freqs} \PYG{o}{=} \PYG{n}{D}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{0.5}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{freqs}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
V=array([[-0.70710678, -0.70710678],
       [ 0.70710678, -0.70710678]]),
D=array([ 48.  +0.j, 109.72+0.j])
V=array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]]),
D=array([109.72,  48.  ])
freqs=array([10.4747315 ,  6.92820323])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
The fundamental frequencies of the system are \sphinxstylestrong{10.47 rad/s} and \sphinxstylestrong{6.93 rad/s.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
{[} {]} get fundamental frequencies and mode shapes from equation of motion

\item {} 
\sphinxAtStartPar
{[} {]} use system identification to determine fundamental frequencies and mode shapes

\end{itemize}

\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{t}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}0.018868424345884642
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{fft} \PYG{k+kn}{import} \PYG{n}{fft}\PYG{p}{,} \PYG{n}{fftfreq}
\PYG{n}{N} \PYG{o}{=} \PYG{l+m+mi}{1000}
\PYG{c+c1}{\PYGZsh{} T = t[1]}
\PYG{c+c1}{\PYGZsh{} T = 0.0189}
\PYG{n}{T} \PYG{o}{=} \PYG{l+m+mf}{1.0}\PYG{o}{/}\PYG{l+m+mi}{800}
\PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{N}\PYG{o}{*}\PYG{n}{T}\PYG{p}{,} \PYG{n}{N}\PYG{p}{,} \PYG{n}{endpoint}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{l+m+mf}{50.0}\PYG{o}{*}\PYG{l+m+mf}{2.0}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{*}\PYG{n}{x}\PYG{p}{)}
\PYG{n}{xf} \PYG{o}{=} \PYG{n}{fftfreq}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{n}{N}\PYG{o}{/}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{yf} \PYG{o}{=} \PYG{n}{fft}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}
\PYG{n}{yff} \PYG{o}{=} \PYG{l+m+mf}{2.0}\PYG{o}{/}\PYG{n}{N} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{yf}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{n}{N}\PYG{o}{/}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xf}\PYG{p}{,} \PYG{n}{yff}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{frequency}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{amplitude}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Frequency Response Spectrum}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{freqs\PYGZus{}fft} \PYG{o}{=} \PYG{n}{xf}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{argpartition}\PYG{p}{(}\PYG{n}{yff}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{freqs\PYGZus{}fft}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
freqs\_fft=array([48.8, 50.4, 49.6])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=386\sphinxpxdimen,height=278\sphinxpxdimen]{{examples_05_MIMO_Event_13_1}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{x} \PYG{o}{=} \PYG{n}{t}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{output}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{N} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} T = x[1]}
\PYG{n}{T} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{800}
\PYG{n}{xf} \PYG{o}{=} \PYG{n}{fftfreq}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{n}{N}\PYG{o}{/}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{n}{yf} \PYG{o}{=} \PYG{n}{fft}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}
\PYG{n}{yff} \PYG{o}{=} \PYG{l+m+mf}{2.0}\PYG{o}{/}\PYG{n}{N} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{yf}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{n}{N}\PYG{o}{/}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xf}\PYG{p}{,} \PYG{n}{yff}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{frequency}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{amplitude}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Frequency Response Spectrum}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} plt.xlim([0,5])}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{argpartition}\PYG{p}{(}\PYG{n}{yff}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{freqs\PYGZus{}fft} \PYG{o}{=} \PYG{n}{xf}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{argpartition}\PYG{p}{(}\PYG{n}{yff}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{freqs\PYGZus{}fft}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
[array([ 1, 21, 31, 32,  0], dtype=int64)]
freqs\_fft=array([ 0.8, 16.8, 24.8, 25.6,  0. ])
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=405\sphinxpxdimen,height=278\sphinxpxdimen]{{examples_05_MIMO_Event_14_1}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{freqs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{freqs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{freqs\PYGZus{}fft}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{freqs\PYGZus{}fft}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
freqs[1]/freqs[0]=0.6614206034955363
freqs\_fft[1]/freqs\_fft[0]=21.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{freqs\PYGZus{}fft}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{/}\PYG{n}{freqs}\PYG{o}{/}\PYG{n}{pi}

\PYG{c+c1}{\PYGZsh{} np.sqrt(2)/2}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}0.8660254037844386
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Parameterization of inputs and outputs for OKID\sphinxhyphen{}ERA and SRIM}
\label{\detokenize{examples/05_MIMO_Event:Parameterization-of-inputs-and-outputs-for-OKID-ERA-and-SRIM}}
\sphinxAtStartPar
I X O \sphinxhyphen{}\textgreater{} SS

\sphinxAtStartPar
Class SS \sphinxhyphen{} coeff: A, B, C, D \sphinxhyphen{} obsv: \(\mathcal{O}_{p}\) or \(V\) or \(V_r\) \sphinxhyphen{} ctrl: \(\mathcal{C}_{p}\) or \(W\) or \(W_s\) \sphinxhyphen{} shapes: \(\Phi, \Psi\) \sphinxhyphen{} freq: \(\Omega, \Lambda\)

\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[9]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{tf} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pi}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{n}{tf}\PYG{p}{,} \PYG{l+m+mi}{1000}\PYG{p}{)}
\PYG{n}{td} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{n}{tf}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{t}\PYG{p}{)}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{continuous}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{td}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{td}\PYG{p}{)}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{discrete}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{time (s)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{signal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{both}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{which}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{major}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=409\sphinxpxdimen,height=268\sphinxpxdimen]{{examples_05_MIMO_Event_18_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[10]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} SDOF example for impulse response and system id}

\PYG{c+c1}{\PYGZsh{} Timesteps}
\PYG{n}{tf} \PYG{o}{=} \PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{pi}
\PYG{n}{nt} \PYG{o}{=} \PYG{l+m+mi}{100}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.}\PYG{p}{,} \PYG{n}{tf}\PYG{p}{,} \PYG{n}{nt}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Impulse input}
\PYG{n+nb}{input} \PYG{o}{=} \PYG{k}{lambda} \PYG{n}{t}\PYG{p}{:} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1} \PYG{o}{\PYGZlt{}} \PYG{n}{t} \PYG{o}{\PYGZlt{}} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mf}{0.1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Mass, stiffness, and damping}
\PYG{n}{m} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{100}
\PYG{n}{w} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{k}\PYG{o}{/}\PYG{n}{m}\PYG{p}{)}
\PYG{n}{c} \PYG{o}{=} \PYG{l+m+mf}{0.05}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m}\PYG{o}{*}\PYG{n}{w}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} fig, ax = plt.subplots(1,2, figsize=(10,3.5))}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{input}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{eom}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{m}\PYG{p}{,}\PYG{n}{c}\PYG{p}{,}\PYG{n}{k}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{[}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{o}{*}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{o}{*}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{t}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{output} \PYG{o}{=} \PYG{n}{integrate}\PYG{o}{.}\PYG{n}{odeint}\PYG{p}{(}\PYG{n}{eom}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{1e\PYGZhy{}5}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{args}\PYG{o}{=}\PYG{p}{(}\PYG{n}{m}\PYG{p}{,}\PYG{n}{c}\PYG{p}{,}\PYG{n}{k}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} ax[1].step(t, output[:,0], where=\PYGZsq{}post\PYGZsq{})}
\PYG{c+c1}{\PYGZsh{} ax[1].plot(t, output[:,0], where=\PYGZsq{}post\PYGZsq{})}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{o}{*}\PYG{n}{output}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{o}{*}\PYG{n}{output}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} ax[1].plot(t, [\PYGZhy{}k*output[i,0]/m\PYGZhy{}c*output[i,1]/m\PYGZhy{}input(i) for i in range(nt)])}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{c+c1}{\PYGZsh{} ax[1].plot(t+pi/3\PYGZhy{}0.1, \PYGZhy{}1*np.sin(w*(t+pi/3\PYGZhy{}0.1)));}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=1153\sphinxpxdimen,height=210\sphinxpxdimen]{{examples_05_MIMO_Event_19_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mf}{4.5}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{impulse input}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}xaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}yaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}t\PYGZdl{} (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{ddot}\PYG{l+s+si}{\PYGZob{}u\PYGZcb{}}\PYG{l+s+s1}{\PYGZdl{} (cm/s\PYGZdl{}\PYGZca{}2\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mf}{4.5}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{,} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{o}{*}\PYG{n}{output}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{o}{*}\PYG{n}{output}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{impulse output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}xaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}yaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}t\PYGZdl{} (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{ddot}\PYG{l+s+si}{\PYGZob{}u\PYGZcb{}}\PYG{l+s+s1}{\PYGZdl{} (cm/s\PYGZdl{}\PYGZca{}2\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=269\sphinxpxdimen,height=201\sphinxpxdimen]{{examples_05_MIMO_Event_20_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=269\sphinxpxdimen,height=201\sphinxpxdimen]{{examples_05_MIMO_Event_20_1}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k}{def} \PYG{n+nf}{husid}\PYG{p}{(}\PYG{n}{accRH}\PYG{p}{,} \PYG{n}{plothusid}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{n}{lb}\PYG{o}{=}\PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{n}{ub}\PYG{o}{=}\PYG{l+m+mf}{0.95}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{ai} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{tril}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{accRH}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{n+nd}{@accRH}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
    \PYG{n}{husid} \PYG{o}{=} \PYG{n}{ai}\PYG{o}{/}\PYG{n}{ai}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n}{ilb} \PYG{o}{=} \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{x} \PYG{k}{for} \PYG{n}{x}\PYG{p}{,} \PYG{n}{val} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{husid}\PYG{p}{)} \PYG{k}{if} \PYG{n}{val} \PYG{o}{\PYGZgt{}} \PYG{n}{lb}\PYG{p}{)}
    \PYG{n}{iub} \PYG{o}{=} \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{x} \PYG{k}{for} \PYG{n}{x}\PYG{p}{,} \PYG{n}{val} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{husid}\PYG{p}{)} \PYG{k}{if} \PYG{n}{val} \PYG{o}{\PYGZgt{}} \PYG{n}{ub}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{plothusid}\PYG{p}{:}
        \PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
        \PYG{k}{if} \PYG{n}{dt} \PYG{o+ow}{is} \PYG{o+ow}{not} \PYG{k+kc}{None}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{duration between }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{lb}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ and }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{ub}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ (s): }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{dt}\PYG{o}{*}\PYG{p}{(}\PYG{n}{iub}\PYG{o}{\PYGZhy{}}\PYG{n}{ilb}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{dt}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{accRH}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{husid}\PYG{p}{)}
            \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{time (s)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{accRH}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{husid}\PYG{p}{)}
            \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timestep}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{axhline}\PYG{p}{(}\PYG{n}{husid}\PYG{p}{[}\PYG{n}{ilb}\PYG{p}{]}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{lb}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{axhline}\PYG{p}{(}\PYG{n}{husid}\PYG{p}{[}\PYG{n}{iub}\PYG{p}{]}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{ub}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Husid Plot}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{ilb}\PYG{p}{,} \PYG{n}{iub}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[13]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} San Lorenzo Bent 4 south column base input}
\PYG{k+kn}{from} \PYG{n+nn}{pathlib} \PYG{k+kn}{import} \PYG{n}{Path}
\PYG{k+kn}{import} \PYG{n+nn}{quakeio}
\PYG{n}{event\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./hayward/58658\PYGZus{}003\PYGZus{}20210628\PYGZus{}18.29.26.P\PYGZus{}SanLo.zip}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{event} \PYG{o}{=} \PYG{n}{quakeio}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{n}{event\PYGZus{}path}\PYG{p}{)}
\PYG{n}{channel} \PYG{o}{=} \PYG{n}{event}\PYG{o}{.}\PYG{n}{match}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{l}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{station\PYGZus{}channel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{25}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{response} \PYG{o}{=} \PYG{n}{channel}\PYG{o}{.}\PYG{n}{accel}\PYG{o}{.}\PYG{n}{data}
\PYG{n}{wt} \PYG{o}{=} \PYG{n}{husid}\PYG{p}{(}\PYG{n}{response}\PYG{p}{,} \PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{n}{lb}\PYG{o}{=}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{n}{ub}\PYG{o}{=}\PYG{l+m+mf}{0.99}\PYG{p}{)}
\PYG{n}{nt} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{response}\PYG{p}{)}
\PYG{n}{dt} \PYG{o}{=} \PYG{l+m+mf}{0.01}
\PYG{n}{nf} \PYG{o}{=} \PYG{n}{dt}\PYG{o}{*}\PYG{n}{nt}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{nf}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{)}
\PYG{n+nb}{input} \PYG{o}{=} \PYG{k}{lambda} \PYG{n}{t}\PYG{p}{:} \PYG{n}{response}\PYG{p}{[}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{t}\PYG{o}{/}\PYG{n}{dt}\PYG{p}{)}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Mass, stiffness, and damping}
\PYG{n}{m} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{100}
\PYG{n}{w} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{k}\PYG{o}{/}\PYG{n}{m}\PYG{p}{)}
\PYG{n}{c} \PYG{o}{=} \PYG{l+m+mf}{0.05}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m}\PYG{o}{*}\PYG{n}{w}

\PYG{c+c1}{\PYGZsh{} fig, ax = plt.subplots(1,2, figsize=(15,5))}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{input}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{eom}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{m}\PYG{p}{,}\PYG{n}{c}\PYG{p}{,}\PYG{n}{k}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{[}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{o}{*}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{o}{*}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{t}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{output} \PYG{o}{=} \PYG{n}{integrate}\PYG{o}{.}\PYG{n}{odeint}\PYG{p}{(}\PYG{n}{eom}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{1e\PYGZhy{}5}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{args}\PYG{o}{=}\PYG{p}{(}\PYG{n}{m}\PYG{p}{,}\PYG{n}{c}\PYG{p}{,}\PYG{n}{k}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{accel\PYGZus{}output} \PYG{o}{=} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{o}{*}\PYG{n}{output}\PYG{p}{[}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{ti}\PYG{o}{/}\PYG{n}{dt}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{o}{*}\PYG{n}{output}\PYG{p}{[}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{ti}\PYG{o}{/}\PYG{n}{dt}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{/}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{accel\PYGZus{}output}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} markerline, stemlines, baseline = ax[1].stem(t[wt[0]:wt[1]], accel\PYGZus{}output[wt[0]:wt[1]], basefmt=\PYGZsq{} \PYGZsq{}, linefmt=\PYGZsq{}\PYGZhy{}\PYGZsq{}, markerfmt=\PYGZsq{} \PYGZsq{})}
\PYG{c+c1}{\PYGZsh{} plt.setp(stemlines, \PYGZsq{}linewidth\PYGZsq{}, 0.5)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{c+c1}{\PYGZsh{} ax[1].plot(t+pi/3, \PYGZhy{}0.01*np.sin(w*(t+pi/3)));}

\PYG{c+c1}{\PYGZsh{} plt.subplots(figsize=(12,3))}
\PYG{c+c1}{\PYGZsh{} markerline, stemlines, baseline = plt.stem(t[wt[0]:wt[1]], accel\PYGZus{}output[wt[0]:wt[1]], basefmt=\PYGZsq{} \PYGZsq{})}
\PYG{c+c1}{\PYGZsh{} plt.setp(stemlines, \PYGZsq{}linewidth\PYGZsq{}, 0.5)}
\PYG{c+c1}{\PYGZsh{} plt.setp(markerline, \PYGZsq{}markersize\PYGZsq{}, 2);}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=1161\sphinxpxdimen,height=210\sphinxpxdimen]{{examples_05_MIMO_Event_22_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[14]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mf}{4.5}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n+nb}{input}\PYG{p}{(}\PYG{n}{ti}\PYG{p}{)} \PYG{k}{for} \PYG{n}{ti} \PYG{o+ow}{in} \PYG{n}{t}\PYG{p}{]}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time history input}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}xaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}yaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}t\PYGZdl{} (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{ddot}\PYG{l+s+si}{\PYGZob{}u\PYGZcb{}}\PYG{l+s+s1}{\PYGZdl{} (cm/s\PYGZdl{}\PYGZca{}2\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mf}{4.5}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{step}\PYG{p}{(}\PYG{n}{t}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{accel\PYGZus{}output}\PYG{p}{[}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{:}\PYG{n}{wt}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{where}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{post}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time history output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}xaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{axes}\PYG{o}{.}\PYG{n}{get\PYGZus{}yaxis}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{set\PYGZus{}visible}\PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}t\PYGZdl{} (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{ddot}\PYG{l+s+si}{\PYGZob{}u\PYGZcb{}}\PYG{l+s+s1}{\PYGZdl{} (cm/s\PYGZdl{}\PYGZca{}2\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=269\sphinxpxdimen,height=201\sphinxpxdimen]{{examples_05_MIMO_Event_23_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=269\sphinxpxdimen,height=201\sphinxpxdimen]{{examples_05_MIMO_Event_23_1}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Continuous vs Discrete}
\label{\detokenize{examples/05_MIMO_Event:Continuous-vs-Discrete}}\begin{equation*}
\begin{split}\dot{x} = A_{c}x\end{split}
\end{equation*}\begin{equation*}
\begin{split}A_{c} = \Psi \Lambda \Psi^{-1}\end{split}
\end{equation*}\begin{equation*}
\begin{split}x\left((k+1)\Delta t\right) = A_{d}x(k\Delta t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}A_{d} = e^{A_{c}\Delta t}\end{split}
\end{equation*}\begin{equation*}
\begin{split}A_{d} = \Psi \Gamma \Psi^{-1} = e^{\Psi \Lambda \Psi^{-1}\Delta t} = {\Psi e^{\Lambda\Delta t}\Psi^{-1}}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\Gamma = e^{\Lambda\Delta t}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\lambda_{j} = \frac{\ln{\gamma_{j}}}{\Delta t}\end{split}
\end{equation*}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[15]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{linalg} \PYG{k}{as} \PYG{n+nn}{sl}

\PYG{n}{dt} \PYG{o}{=} \PYG{l+m+mf}{0.01}
\PYG{n}{tf} \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{n}{nt} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{tf}\PYG{o}{/}\PYG{n}{dt}\PYG{p}{)}
\PYG{n}{t} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{tf}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{)}
\PYG{k}{assert} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{t}\PYG{p}{)} \PYG{o}{==} \PYG{n}{nt}

\PYG{c+c1}{\PYGZsh{} Mass, stiffness, and damping}
\PYG{n}{m} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{100}
\PYG{n}{w} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{k}\PYG{o}{/}\PYG{n}{m}\PYG{p}{)}
\PYG{n}{c} \PYG{o}{=} \PYG{l+m+mf}{0.02}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m}\PYG{o}{*}\PYG{n}{w}
\PYG{n}{z} \PYG{o}{=} \PYG{n}{c}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m}\PYG{o}{*}\PYG{n}{w}\PYG{p}{)}

\PYG{n}{Ac} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{o}{/}\PYG{n}{m}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{o}{/}\PYG{n}{m}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Ac}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{Ad} \PYG{o}{=} \PYG{n}{sl}\PYG{o}{.}\PYG{n}{expm}\PYG{p}{(}\PYG{n}{Ac}\PYG{o}{*}\PYG{n}{dt}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Ad}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{Gam}\PYG{p}{,}\PYG{n}{Psi} \PYG{o}{=} \PYG{n}{sl}\PYG{o}{.}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{Ad}\PYG{p}{)}
\PYG{n}{Lam}\PYG{p}{,}\PYG{n}{Psic} \PYG{o}{=} \PYG{n}{sl}\PYG{o}{.}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{Ac}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Psi}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Psic}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Gam}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{Lam}\PYG{o}{*}\PYG{n}{dt}\PYG{p}{)}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{Lam}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{Gam}\PYG{p}{)}\PYG{o}{/}\PYG{n}{dt}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{lams} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{Gam}\PYG{p}{)}\PYG{o}{/}\PYG{n}{dt}
\PYG{n}{omegas} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{lams}\PYG{o}{*}\PYG{n}{lams}\PYG{o}{.}\PYG{n}{conj}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{zetas} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{real}\PYG{p}{(}\PYG{n}{lams}\PYG{o}{/}\PYG{n}{omegas}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{omegas}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{zetas}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{w}\PYG{l+s+si}{=\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Ac=array([[   0. ,    1. ],
       [-100. ,   -0.4]])
Ad=array([[ 0.99501082,  0.0099634 ],
       [-0.99634016,  0.99102546]])
Psi=array([[-0.00199007-0.09948382j, -0.00199007+0.09948382j],
       [ 0.99503719+0.j        ,  0.99503719-0.j        ]])
Psic=array([[-0.00199007-0.09948382j, -0.00199007+0.09948382j],
       [ 0.99503719+0.j        ,  0.99503719-0.j        ]])
Gam=array([0.99301814+0.09961409j, 0.99301814-0.09961409j])
np.exp(Lam*dt)=array([0.99301814+0.09961409j, 0.99301814-0.09961409j])
Lam=array([-0.2+9.9979998j, -0.2-9.9979998j])
np.log(Gam)/dt=array([-0.2+9.9979998j, -0.2-9.9979998j])
omegas=array([10.+0.j, 10.+0.j])
zetas=array([0.02, 0.02])
w=10.0
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Trajectories}
\label{\detokenize{examples/05_MIMO_Event:Trajectories}}\begin{equation*}
\begin{split}\dot{x} = A_{c}x\end{split}
\end{equation*}\begin{equation*}
\begin{split}A_{d} = e^{A_{c}\Delta t}\end{split}
\end{equation*}\begin{equation*}
\begin{split}x\left((k+1)\Delta t\right) = A_{d}x(k\Delta t) = e^{A_{c}\Delta t}x(k\Delta t)\end{split}
\end{equation*}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[16]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{A1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{A2} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{A3} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}

\PYG{k+kn}{from} \PYG{n+nn}{sympy}\PYG{n+nn}{.}\PYG{n+nn}{matrices} \PYG{k+kn}{import} \PYG{n}{Matrix}
\PYG{n}{display}\PYG{p}{(}\PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{Ac}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}0 & 1.0\\-100.0 & -0.4\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[17]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{x0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{xs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{xs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{x0}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} xs[:,i] = A3@xs[:,i\PYGZhy{}1]}
    \PYG{n}{xs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Ad}\PYG{n+nd}{@xs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{c+c1}{\PYGZsh{} xs[:,i] = xs[:,i\PYGZhy{}1]+Ac@xs[:,i\PYGZhy{}1]*dt}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}\begin{equation*}
\begin{split}x_{k+1} = e^{A_{c}\Delta t}x_{k}\end{split}
\end{equation*}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[18]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{State Evolution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=405\sphinxpxdimen,height=278\sphinxpxdimen]{{examples_05_MIMO_Event_30_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[19]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=393\sphinxpxdimen,height=278\sphinxpxdimen]{{examples_05_MIMO_Event_31_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[20]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{sdof}
\PYG{n}{u}\PYG{p}{,}\PYG{n}{v}\PYG{p}{,}\PYG{n}{a} \PYG{o}{=} \PYG{n}{sdof}\PYG{o}{.}\PYG{n}{integrate}\PYG{p}{(}\PYG{n}{m}\PYG{p}{,}\PYG{n}{c}\PYG{p}{,}\PYG{n}{k}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{nt}\PYG{p}{)}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{n}{v0}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{v}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[20]:\,\hspace{\fboxrule}\hspace{\fboxsep}}[<matplotlib.lines.Line2D at 0x20b087f5a00>]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=386\sphinxpxdimen,height=248\sphinxpxdimen]{{examples_05_MIMO_Event_32_1}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[21]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=386\sphinxpxdimen,height=278\sphinxpxdimen]{{examples_05_MIMO_Event_33_0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{ERA}
\label{\detokenize{examples/05_MIMO_Event:ERA}}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[22]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{sympy}\PYG{n+nn}{.}\PYG{n+nn}{matrices} \PYG{k+kn}{import} \PYG{n}{Matrix}
\PYG{k+kn}{from} \PYG{n+nn}{sympy} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{n}{k}\PYG{p}{,} \PYG{n}{m}\PYG{p}{,} \PYG{n}{w}\PYG{p}{,} \PYG{n}{dt}\PYG{p}{,} \PYG{n}{tau} \PYG{o}{=} \PYG{n}{symbols}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k,m,}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{omega\PYGZus{}}\PYG{l+s+si}{\PYGZob{}n\PYGZcb{}}\PYG{l+s+s1}{,}\PYG{l+s+s1}{\PYGZob{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{Delta\PYGZcb{}t,}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{tau}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Ac} \PYG{o}{=} \PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{n}{w}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Bc} \PYG{o}{=} \PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{C} \PYG{o}{=} \PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{n}{w}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{D} \PYG{o}{=} \PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{display}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Ac=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{Ac}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
'Ac='
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}0 & 1\\- \omega_{n}^{2} & 0\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[23]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{display}\PYG{p}{(}\PYG{n}{Ac}\PYG{o}{.}\PYG{n}{diagonalize}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}\frac{i}{\omega_{n}} & - \frac{i}{\omega_{n}}\\1 & 1\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[24]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{display}\PYG{p}{(}\PYG{n}{Ac}\PYG{o}{.}\PYG{n}{diagonalize}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}- i \omega_{n} & 0\\0 & i \omega_{n}\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[25]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{i} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{n}{Lam} \PYG{o}{=} \PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{n}{i}\PYG{o}{*}\PYG{n}{w}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}  \PYG{o}{\PYGZhy{}}\PYG{n}{i}\PYG{o}{*}\PYG{n}{w}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Psi} \PYG{o}{=} \PYG{n}{Matrix}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{n}{i}\PYG{o}{*}\PYG{n}{w}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{i}\PYG{o}{*}\PYG{n}{w}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[26]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{Psi}\PYG{n+nd}{@Lam}\PYG{n+nd}{@Psi}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\savebox\nbsphinxpromptbox[0pt][r]{\color{nbsphinxout}\Verb|\strut{[26]:}\,|}

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}0 & 1.0\\- 1.0 \omega_{n}^{2} & 0\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[27]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{A} \PYG{o}{=} \PYG{n}{Psi}\PYG{n+nd}{@exp}\PYG{p}{(}\PYG{n}{Lam}\PYG{o}{*}\PYG{n}{dt}\PYG{p}{)}\PYG{n+nd}{@Psi}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[28]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{A} \PYG{o}{=} \PYG{n}{simplify}\PYG{p}{(}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{Ac}\PYG{o}{*}\PYG{n}{dt}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[29]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{simplify}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\savebox\nbsphinxpromptbox[0pt][r]{\color{nbsphinxout}\Verb|\strut{[29]:}\,|}

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}\cos{\left(\omega_{n} {\Delta}t \right)} & \frac{\sin{\left(\omega_{n} {\Delta}t \right)}}{\omega_{n}}\\- \omega_{n} \sin{\left(\omega_{n} {\Delta}t \right)} & \cos{\left(\omega_{n} {\Delta}t \right)}\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[30]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{Bintegrand} \PYG{o}{=} \PYG{n}{simplify}\PYG{p}{(}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{Ac}\PYG{o}{*}\PYG{n}{tau}\PYG{p}{)}\PYG{n+nd}{@Bc}\PYG{p}{)}
\PYG{n}{Bintegrand}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\savebox\nbsphinxpromptbox[0pt][r]{\color{nbsphinxout}\Verb|\strut{[30]:}\,|}

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}- \frac{\sin{\left(\omega_{n} \tau \right)}}{\omega_{n}}\\- \cos{\left(\omega_{n} \tau \right)}\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[31]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{B} \PYG{o}{=} \PYG{n}{integrate}\PYG{p}{(}\PYG{n}{Bintegrand}\PYG{p}{,}\PYG{p}{(}\PYG{n}{tau}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{B}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\savebox\nbsphinxpromptbox[0pt][r]{\color{nbsphinxout}\Verb|\strut{[31]:}\,|}

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}\begin{cases} \frac{\cos{\left(\omega_{n} {\Delta}t \right)}}{\omega_{n}^{2}} - \frac{1}{\omega_{n}^{2}} & \text{for}\: \omega_{n} > -\infty \wedge \omega_{n} < \infty \wedge \omega_{n} \neq 0 \\0 & \text{otherwise} \end{cases}\\\begin{cases} - \frac{\sin{\left(\omega_{n} {\Delta}t \right)}}{\omega_{n}} & \text{for}\: \omega_{n} > -\infty \wedge \omega_{n} < \infty \wedge \omega_{n} \neq 0 \\- {\Delta}t & \text{otherwise} \end{cases}\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[32]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{simplify}\PYG{p}{(}\PYG{n}{A}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{p}{)}\PYG{n+nd}{@B}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\savebox\nbsphinxpromptbox[0pt][r]{\color{nbsphinxout}\Verb|\strut{[32]:}\,|}

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}$\displaystyle \left[\begin{matrix}\begin{cases} \frac{1 - \cos{\left(\omega_{n} {\Delta}t \right)}}{\omega_{n}^{2}} & \text{for}\: \omega_{n} > -\infty \wedge \omega_{n} < \infty \wedge \omega_{n} \neq 0 \\\frac{{\Delta}t \sin{\left(\omega_{n} {\Delta}t \right)}}{\omega_{n}} & \text{otherwise} \end{cases}\\\begin{cases} - \frac{\sin{\left(\omega_{n} {\Delta}t \right)}}{\omega_{n}} & \text{for}\: \omega_{n} > -\infty \wedge \omega_{n} < \infty \wedge \omega_{n} \neq 0 \\- {\Delta}t \cos{\left(\omega_{n} {\Delta}t \right)} & \text{otherwise} \end{cases}\end{matrix}\right]$
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\section{MIMO for Event History}
\label{\detokenize{examples/06_MIMO_History:MIMO-for-Event-History}}\label{\detokenize{examples/06_MIMO_History::doc}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{mdof}
\PYG{k+kn}{import} \PYG{n+nn}{quakeio}
\PYG{k+kn}{from} \PYG{n+nn}{mdof} \PYG{k+kn}{import} \PYG{n}{modal}\PYG{p}{,} \PYG{n}{transform}
\PYG{k+kn}{from} \PYG{n+nn}{mdof}\PYG{n+nn}{.}\PYG{n+nn}{utilities} \PYG{k+kn}{import} \PYG{n}{Config}\PYG{p}{,} \PYG{n}{extract\PYGZus{}channels}\PYG{p}{,} \PYG{n}{list\PYGZus{}files}\PYG{p}{,} \PYG{n}{print\PYGZus{}modes}\PYG{p}{,} \PYG{n}{mode\PYGZus{}statistics}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Data inputs}
\label{\detokenize{examples/06_MIMO_History:Data-inputs}}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{directory} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{../CESMD/CE89324/}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{pattern}  \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{????????*.[zZ][iI][pP]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} pattern = \PYGZdq{}sanlorenzo\PYGZus{}28june2021.zip\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} pattern = \PYGZdq{}*[sb][ae][nr][lk]*\PYGZdq{}}

\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../Caltrans.Hayward/CGS\PYGZus{}data/function\PYGZus{}test\PYGZus{}zips.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{readfile}\PYG{p}{:}
    \PYG{n}{function\PYGZus{}tests} \PYG{o}{=} \PYG{n}{readfile}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{import} \PYG{n+nn}{glob}
\PYG{n}{events} \PYG{o}{=} \PYG{p}{[}\PYG{n}{quakeio}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{n}{event}\PYG{p}{)} \PYG{k}{for} \PYG{n}{event} \PYG{o+ow}{in} \PYG{n}{glob}\PYG{o}{.}\PYG{n}{glob}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../CGS\PYGZus{}data/58658*P.zip}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{if} \PYG{n}{event}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{33}\PYG{p}{:}\PYG{p}{]} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{n}{function\PYGZus{}tests}\PYG{p}{]}

\PYG{k+kn}{from} \PYG{n+nn}{pathlib} \PYG{k+kn}{import} \PYG{n}{Path}
\PYG{c+c1}{\PYGZsh{} for file in Path(directory).glob(pattern):}
\PYG{c+c1}{\PYGZsh{}     if str(file)[\PYGZhy{}33:] in function\PYGZus{}tests:}
\PYG{c+c1}{\PYGZsh{}         print(file)}
\PYG{n}{files} \PYG{o}{=} \PYG{p}{[}\PYG{n}{file} \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{directory}\PYG{p}{)}\PYG{o}{.}\PYG{n}{glob}\PYG{p}{(}\PYG{n}{pattern}\PYG{p}{)} \PYG{k}{if} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{file}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{33}\PYG{p}{:}\PYG{p}{]} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{n}{function\PYGZus{}tests}\PYG{p}{]}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{n}{data\PYGZus{}conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} PAINTER RIO DELL TRANSVERSE (CASE 1)}
\PYG{n}{title} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Painter St Bridge Transverse Mode (In: Ch17, Out: Ch9)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{data\PYGZus{}conf}\PYG{o}{.}\PYG{n}{inputs}  \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{17}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{]}
\PYG{n}{data\PYGZus{}conf}\PYG{o}{.}\PYG{n}{outputs} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} PAINTER RIO DELL LONGITUDINAL (CASE 2)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [15,1,18]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [11]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} HWY8/MELOLAND TRANSVERSE (CASE 1)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [2],}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [5,7,9]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} HWY8/MELOLAND TRANSVERSE (CASE 2)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [11,2,26],}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [5,7,9]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} HWY8/MELOLAND LONGITUDINAL (CASE 3)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [12,4,25],}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [27,8]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} CROWLEY TRANSVERSE (CASE 1)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs = [4]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [6,7,9]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} CROWLEY TRANSVERSE (CASE 2)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs = [6,4,9]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [7]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} CROWLEY TRANSVERSE (CASE 3)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs = [4]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [7]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} CROWLEY LONGITUDINAL (CASE 4)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs = [5]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [8]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} RIDGECREST TRANSVERSE (CASE 1)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [4]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [6,7,9]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} CAPISTRANO TRANSVERSE (CASE 1)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [4]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [10,7]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} HAYWARD TRANSVERSE (CASE 1)}
\PYG{c+c1}{\PYGZsh{} title = \PYGZdq{}Hayward Bridge Transverse Mode (In: Ch25, Out: Ch23)\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [25,2,7,18]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [23,13,15,20]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} HAYWARD LONGITUDINAL (CASE 2)}
\PYG{c+c1}{\PYGZsh{} title = \PYGZdq{}Hayward Bridge Longitudinal Mode (In: Ch3, Out: Ch12)\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [3,6,17]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [12,14,19]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} HAYWARD LONGITUDINAL Alternative}
\PYG{c+c1}{\PYGZsh{} title = \PYGZdq{}Hayward Bridge Longitudinal Mode (In: Ch6, Out: Ch14)\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [6,3,17]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [14,12,19]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} BERNARDINO TRANSVERSE BENT 3 (CASE 1)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [6]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [7,8]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} BERNARDINO TRANSVERSE BENT 8 (CASE 2)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [24]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [19,20]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} BERNARDINO LONGITUDINAL BENT 3 (CASE 3)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [4]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [10]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} BERNARDINO LONGITUDINAL BENT 8 (CASE 4)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [22]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [17,18]}

\PYG{c+c1}{\PYGZsh{} \PYGZsh{} VINCENT THOMAS (CE14406) TRANSVERSE (CASE 1)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [1,9,24]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [2,5,7]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} VINCENT THOMAS TRANSVERSE DENSE (CASE 2)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [1,9,24]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [2,4,5,6,7]}
\PYG{c+c1}{\PYGZsh{} \PYGZsh{} VINCENT THOMAS VERTICAL SOUTH DECK EDGE (CASE 3)}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.inputs  = [14,19,26]}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}conf.outputs = [16,18,22]}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Method Inputs}
\label{\detokenize{examples/06_MIMO_History:Method-Inputs}}

\subsection{General Parameters}
\label{\detokenize{examples/06_MIMO_History:General-Parameters}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{p}}
&
\sphinxAtStartPar
number of output channels
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{q}}
&
\sphinxAtStartPar
number of input channels
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nt}}
&
\sphinxAtStartPar
number of timesteps
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dt}}
&
\sphinxAtStartPar
timestep
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{decimation}}
&
\sphinxAtStartPar
decimation (downsampling) factor
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{order}}
&
\sphinxAtStartPar
model order (2 times number of DOF)
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsection{Specific to Observer Kalman Identification (OKID)}
\label{\detokenize{examples/06_MIMO_History:Specific-to-Observer-Kalman-Identification-(OKID)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{m}}
&
\sphinxAtStartPar
number of Markov parameters to compute (at most = nt)
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsection{Specific to Eigensystem Realization Algorithm (ERA)}
\label{\detokenize{examples/06_MIMO_History:Specific-to-Eigensystem-Realization-Algorithm-(ERA)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{horizon}}
&
\sphinxAtStartPar
number of observability parameters, or prediction horizon
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{nc}}
&
\sphinxAtStartPar
number of controllability parameters
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsection{Specific to Data Correlations (DC)}
\label{\detokenize{examples/06_MIMO_History:Specific-to-Data-Correlations-(DC)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{a}}
&
\sphinxAtStartPar
(alpha) number of additional block rows in Hankel matrix of correlation matrices
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{b}}
&
\sphinxAtStartPar
(beta) number of additional block columns in Hankel matrix of correlation matrices
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{l}}
&
\sphinxAtStartPar
initial lag
\\
\sphinxhline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{g}}
&
\sphinxAtStartPar
lag (gap) between correlations
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsection{Specific to System Realization with Information Matrix (SRIM)}
\label{\detokenize{examples/06_MIMO_History:Specific-to-System-Realization-with-Information-Matrix-(SRIM)}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{horizon}}
&
\sphinxAtStartPar
number of steps used for identification, or prediction horizon
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsection{Parameters for Mode Validation}
\label{\detokenize{examples/06_MIMO_History:Parameters-for-Mode-Validation}}

\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
value
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{outlook}}
&
\sphinxAtStartPar
number of steps used for temporal consistency in EMAC
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\begin{sphinxuseclass}{nbinput}
\begin{sphinxuseclass}{nblast}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} Set Parameters}
\PYG{n}{conf} \PYG{o}{=} \PYG{n}{Config}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{m}  \PYG{o}{=} \PYG{l+m+mi}{500}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{horizon} \PYG{o}{=} \PYG{l+m+mi}{190}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{nc} \PYG{o}{=} \PYG{l+m+mi}{190}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{order}  \PYG{o}{=} \PYG{l+m+mi}{12}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{a}  \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{b}  \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{l}  \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{g}  \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{l+m+mf}{0.6}\PYG{p}{)}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{damping} \PYG{o}{=} \PYG{l+m+mf}{0.06}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{pseudo} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{n}{conf}\PYG{o}{.}\PYG{n}{outlook} \PYG{o}{=} \PYG{l+m+mi}{190}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{nbinput}
{
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{c+c1}{\PYGZsh{} event\PYGZus{}names = [\PYGZdq{}Berkeley\PYGZdq{}, \PYGZdq{}San Lorenzo\PYGZdq{}]}
\PYG{n}{event\PYGZus{}modes} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
\PYG{k+kn}{from} \PYG{n+nn}{matplotlib} \PYG{k+kn}{import} \PYG{n}{pyplot} \PYG{k}{as} \PYG{n}{plt}
\PYG{n}{file\PYGZus{}axes} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{axs} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{files}\PYG{p}{)}\PYG{p}{,} \PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{files}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{sharex}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{constrained\PYGZus{}layout}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{axi} \PYG{o}{=} \PYG{n+nb}{iter}\PYG{p}{(}\PYG{n}{axs}\PYG{p}{)}

\PYG{n}{method} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{srim}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{files}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{ax} \PYG{o}{=} \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{axi}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} fig, ax = plt.subplots(figsize=(10,5))}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{file}\PYG{p}{)}
    \PYG{k}{try}\PYG{p}{:}
        \PYG{n}{event} \PYG{o}{=} \PYG{n}{quakeio}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{n}{file}\PYG{p}{,} \PYG{n}{exclusions}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{*filter*}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}\PYG{c+c1}{\PYGZsh{}, \PYGZdq{}*date*\PYGZdq{}])}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{peak acceleration (cm/s/s):}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{event}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{peak\PYGZus{}accel}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{inputs}\PYG{p}{,} \PYG{n}{dt} \PYG{o}{=} \PYG{n}{extract\PYGZus{}channels}\PYG{p}{(}\PYG{n}{event}\PYG{p}{,} \PYG{n}{data\PYGZus{}conf}\PYG{o}{.}\PYG{n}{inputs}\PYG{p}{)}
        \PYG{n}{outpts}\PYG{p}{,} \PYG{n}{dt} \PYG{o}{=} \PYG{n}{extract\PYGZus{}channels}\PYG{p}{(}\PYG{n}{event}\PYG{p}{,} \PYG{n}{data\PYGZus{}conf}\PYG{o}{.}\PYG{n}{outputs}\PYG{p}{)}
        \PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{8} \PYG{c+c1}{\PYGZsh{} decimation factor for state space method}
        \PYG{n}{realization} \PYG{o}{=} \PYG{n}{mdof}\PYG{o}{.}\PYG{n}{system}\PYG{p}{(}\PYG{n}{method}\PYG{o}{=}\PYG{n}{method}\PYG{p}{,} \PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outpts}\PYG{p}{,} \PYG{n}{threads}\PYG{o}{=}\PYG{l+m+mi}{18}\PYG{p}{,} \PYG{n}{chunk}\PYG{o}{=}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} raise e}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{file}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
        \PYG{k}{continue}
    \PYG{n}{ss\PYGZus{}modes} \PYG{o}{=} \PYG{n}{modal}\PYG{o}{.}\PYG{n}{system\PYGZus{}modes}\PYG{p}{(}\PYG{n}{realization}\PYG{p}{,}\PYG{n}{dt}\PYG{p}{,}\PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{n}{event\PYGZus{}modes}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{print\PYGZus{}modes}\PYG{p}{(}\PYG{n}{ss\PYGZus{}modes}\PYG{p}{)}
    \PYG{n}{conf}\PYG{o}{.}\PYG{n}{decimation} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{c+c1}{\PYGZsh{} decimation factor for transfer function methods}
    \PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outpts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{step}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{amplitudes}\PYG{o}{/}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{fourier}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{l+m+mi}{0} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{blue}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}, alpha = (1/(len(files)+2))*(i+1))}
    \PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{transform}\PYG{o}{.}\PYG{n}{response\PYGZus{}transfer}\PYG{p}{(}\PYG{n}{inputs}\PYG{o}{=}\PYG{n}{inputs}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{outputs}\PYG{o}{=}\PYG{n}{outpts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{step}\PYG{o}{=}\PYG{n}{dt}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{threads}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{conf}\PYG{p}{)}
    \PYG{n}{amplitudes} \PYG{o}{=} \PYG{n}{amplitudes}\PYG{o}{/}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{periods}\PYG{p}{,} \PYG{n}{amplitudes}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{response spectrum}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{l+m+mi}{0} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{green}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}, alpha = (1/(len(files)+2))*(i+1))}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{vlines}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{value}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{k}{for} \PYG{n}{value} \PYG{o+ow}{in} \PYG{n}{ss\PYGZus{}modes}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)} \PYG{k}{if} \PYG{n}{value}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{energy\PYGZus{}condensed\PYGZus{}emaco}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{\PYGZgt{}}\PYG{l+m+mf}{0.5} \PYG{o+ow}{and} \PYG{n}{value}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mpc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{\PYGZgt{}}\PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linestyles}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dashed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{state space (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{method}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{)}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{l+m+mi}{0} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{period\PYGZus{}band}\PYG{p}{)}
    \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{n}{event}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{event\PYGZus{}date}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{bbox\PYGZus{}to\PYGZus{}anchor}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mf}{1.45}\PYG{p}{,}\PYG{l+m+mf}{0.85}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{event\PYGZus{}frequencies} \PYG{o}{=} \PYG{n}{mode\PYGZus{}statistics}\PYG{p}{(}\PYG{n}{event\PYGZus{}modes}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{freq}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{suptitle}\PYG{p}{(}\PYG{n}{title}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\end{sphinxVerbatim}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
../CESMD/CE89324/bayview\_11oct2013\_72086051\_ce89324p.zip
peak acceleration (cm/s/s): 87.954
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 1310/1311 [00:00<00:00, 2237.95it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2709     0.001132   1.0        0.8338     0.8338
      0.2527     -0.003276  1.0        0.9749     0.9749
      0.2409     -0.0003217  1.0        0.8874     0.8874
      0.2337     -0.0001491  1.0        0.8368     0.8368
      0.2282     0.03774    1.0        0.9219     0.9219
      0.2133     0.02379    1.0        0.3374     0.3374
Mean Period(s): 0.23994997335785784
Standard Dev(s): 0.01829979557828316
../CESMD/CE89324/ferndaleoffshore\_08dec2016\_us20007z6r\_ce89324p.zip
peak acceleration (cm/s/s): -30.371
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 686/687 [00:00<00:00, 2885.01it/s]
/mnt/c/Users/cmp/Documents/GitHub/SystemIdentification/src/mdof/validation.py:137: RuntimeWarning: divide by zero encountered in scalar divide
  nu[i]    = (s22[i]-s11[i])/(2*s12[i])
/mnt/c/Users/cmp/Documents/GitHub/SystemIdentification/src/mdof/validation.py:138: RuntimeWarning: invalid value encountered in scalar multiply
  lam[0,i] = (s11[i]+s22[i])/2 + s12[i]*np.sqrt(nu[i]**2+1)
/mnt/c/Users/cmp/Documents/GitHub/SystemIdentification/src/mdof/validation.py:139: RuntimeWarning: invalid value encountered in scalar multiply
  lam[1,i] = (s11[i]+s22[i])/2 - s12[i]*np.sqrt(nu[i]**2+1)
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2359     0.0038     1.0        0.9453     0.9453
      0.227      0.03918    1.0        0.9725     0.9725
      0.2238     0.005151   1.0        0.9662     0.9662
      0.2093     0.009579   1.0        0.604      0.604
      0.2032     0.02393    1.0        0.9483     0.9483
Mean Period(s): 0.21983789850293506
Standard Dev(s): 0.011930582991559505
../CESMD/CE89324/ferndale\_28jan2015\_72387946\_ce89324p.zip
peak acceleration (cm/s/s): -285.334
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 874/875 [00:00<00:00, 2546.99it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.3119     0.01321    1.0        0.8887     0.8887
      0.2602     -0.004556  1.0        0.7266     0.7266
      0.2555     0.04334    1.0        0.972      0.972
      0.2482     0.01867    1.0        0.878      0.878
      0.2299     0.008439   1.0        0.7712     0.7712
Mean Period(s): 0.26113898415437486
Standard Dev(s): 0.027387551087975463
../CESMD/CE89324/nc73201181\_ce89324p.zip
peak acceleration (cm/s/s): 243.242
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 831/832 [00:00<00:00, 2802.56it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.7111     0.06989    1.0        0.2373     0.2373
      0.2911     0.4793     0.0        0.2207     0.0
      0.2839     0.01621    1.0        0.9861     0.9861
      0.2669     0.008783   1.0        0.8865     0.8865
      0.2449     0.02909    1.0        0.9715     0.9715
      0.2391     0.09027    0.9849     0.9734     0.9587
Mean Period(s): 0.3394953575119655
Standard Dev(s): 0.16723260983987168
../CESMD/CE89324/nc73351710\_ce89324p.zip
peak acceleration (cm/s/s): -53.539
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 868/869 [00:00<00:00, 2740.65it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2298     0.02758    1.0        0.9018     0.9018
      0.2293     0.01291    1.0        0.6597     0.6597
      0.2141     0.005794   1.0        0.8125     0.8125
      0.198      0.01652    1.0        0.954      0.954
      0.1856     0.007892   1.0        0.9607     0.9607
      0.1639     0.004047   1.0        0.953      0.953
Mean Period(s): 0.20345404869738717
Standard Dev(s): 0.023751109375293063
../CESMD/CE89324/nc73666231\_ce89324p.zip
peak acceleration (cm/s/s): 30.272
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 631/632 [00:00<00:00, 2616.91it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2969     0.04186    1.0        0.3244     0.3244
      0.2725     0.03001    1.0        0.8513     0.8513
      0.2432     0.02007    1.0        0.9816     0.9816
      0.2255     0.03043    1.0        0.8075     0.8075
      0.2231     0.0144     1.0        0.8528     0.8528
      0.1644     0.007564   1.0        0.9913     0.9913
Mean Period(s): 0.23760239670892977
Standard Dev(s): 0.041786791965444915
../CESMD/CE89324/nc73667866\_ce89324p.zip
peak acceleration (cm/s/s): 32.846
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 647/648 [00:00<00:00, 3019.03it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2674     0.07844    1.0        0.2192     0.2192
      0.2388     0.01897    1.0        0.08927    0.08927
      0.2295     0.06567    1.0        0.5181     0.5181
      0.2229     0.03194    1.0        0.1985     0.1985
      0.2029     0.0984     0.004007   0.7416     0.002972
Mean Period(s): 0.23230004145748845
Standard Dev(s): 0.021121709869982592
../CESMD/CE89324/nc73714181\_ce89324p.zip
peak acceleration (cm/s/s): 54.457
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 694/695 [00:00<00:00, 3319.68it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.3978     0.1306     0.999      0.7373     0.7366
      0.3016     0.02847    1.0        0.7979     0.7979
      0.2591     0.03579    1.0        0.7103     0.7103
      0.236      0.009554   1.0        0.8541     0.8541
      0.2        0.03356    1.0        0.4057     0.4057
      0.1853     0.004686   1.0        0.1831     0.1831
Mean Period(s): 0.2633002998041649
Standard Dev(s): 0.0712209453393016
../CESMD/CE89324/nc73821036\_ce89324p.zip
peak acceleration (cm/s/s): -1356.923
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 1229/1230 [00:00<00:00, 2421.65it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.4041     0.02136    1.0        0.1498     0.1498
      0.3177     0.008901   1.0        0.8627     0.8627
      0.3006     0.00409    1.0        0.9268     0.9268
      0.2818     0.019      1.0        0.9697     0.9697
      0.2801     0.007793   1.0        0.8783     0.8783
      0.2441     0.1093     0.0004749  0.9427     0.0004477
Mean Period(s): 0.3047263057826448
Standard Dev(s): 0.049794929438951606
../CESMD/CE89324/nc73821046\_ce89324p.zip
peak acceleration (cm/s/s): -139.897
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 662/663 [00:00<00:00, 2844.54it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.3001     0.04037    1.0        0.7879     0.7879
      0.2674     0.03467    1.0        0.1593     0.1593
      0.2591     0.06272    1.0        0.6758     0.6758
      0.2469     0.03627    1.0        0.8245     0.8245
      0.2256     0.03078    1.0        0.7015     0.7015
      0.1745     0.03043    1.0        0.8787     0.8787
Mean Period(s): 0.24562036099179363
Standard Dev(s): 0.03891069442719765
../CESMD/CE89324/nc73821636\_ce89324p.zip
peak acceleration (cm/s/s): 50.951
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 673/674 [00:00<00:00, 3177.12it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2833     0.009959   1.0        0.6816     0.6816
      0.2434     0.01689    1.0        0.8856     0.8856
      0.2357     0.0112     1.0        0.2451     0.2451
      0.2286     0.07124    0.9998     0.5308     0.5307
      0.2061     0.04924    1.0        0.9692     0.9692
      0.1684     0.03321    1.0        0.5699     0.5699
Mean Period(s): 0.22757668980327647
Standard Dev(s): 0.03510575192028343
../CESMD/CE89324/nc73827571\_ce89324p.zip
peak acceleration (cm/s/s): -1012.657
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 914/915 [00:00<00:00, 2689.89it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.6212     0.09436    1.0        0.6528     0.6528
      0.5406     0.009841   1.0        0.8737     0.8737
      0.4367     0.04506    1.0        0.2452     0.2452
      0.317      0.01029    1.0        0.4412     0.4412
      0.2569     0.08572    0.9968     0.9454     0.9424
Mean Period(s): 0.4344633802066828
Standard Dev(s): 0.13524874602820816
../CESMD/CE89324/nc73890906\_ce89324p.zip
peak acceleration (cm/s/s): 33.218
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 694/695 [00:00<00:00, 2891.35it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2607     0.02224    1.0        0.003157   0.003157
      0.2449     0.006788   1.0        0.9932     0.9932
      0.24       -0.0008864  1.0        0.8373     0.8373
      0.2263     0.02832    1.0        0.7906     0.7906
      0.2163     0.04559    1.0        0.9555     0.9555
      0.1748     0.001106   1.0        0.2454     0.2454
Mean Period(s): 0.22716129703326704
Standard Dev(s): 0.027283894562143994
../CESMD/CE89324/petrolia\_05dec2016\_72733405\_ce89324p.zip
peak acceleration (cm/s/s): 165.262
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 1310/1311 [00:00<00:00, 2282.88it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2964     0.01012    1.0        0.9602     0.9602
      0.2634     0.04313    1.0        0.8054     0.8054
      0.2474     0.0159     1.0        0.8673     0.8673
      0.2425     0.012      1.0        0.8418     0.8418
      0.2228     0.01331    1.0        0.4284     0.4284
      0.2051     0.005986   1.0        0.8064     0.8064
Mean Period(s): 0.246280600421937
Standard Dev(s): 0.02905011899350602
../CESMD/CE89324/riodell\_14sep2012\_71842075\_ce89324p.zip
peak acceleration (cm/s/s): -219.633
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 1310/1311 [00:00<00:00, 2320.65it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2735     0.03582    1.0        0.94       0.94
      0.2556     0.06232    1.0        0.998      0.998
      0.2391     0.005624   1.0        0.9759     0.9759
      0.2049     0.01358    1.0        0.8958     0.8958
      0.1772     0.0223     1.0        0.8821     0.8821
      0.1482     0.01812    1.0        0.3485     0.3485
Mean Period(s): 0.21639806443332765
Standard Dev(s): 0.044021503974172094
../CESMD/CE89324/riodell\_19oct2014\_72330211\_ce89324p.zip
peak acceleration (cm/s/s): -60.641
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 671/672 [00:00<00:00, 2351.78it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2918     0.01039    1.0        0.9987     0.9987
      0.2418     -0.006623  1.0        0.3285     0.3285
      0.2226     0.02352    1.0        0.9517     0.9517
      0.1945     0.1566     3.285e-19  0.9412     3.092e-19
      0.1651     0.006289   1.0        0.7292     0.7292
Mean Period(s): 0.2231605195046272
Standard Dev(s): 0.04301403503187152
../CESMD/CE89324/RioDell\_Petrolia\_Processed\_Data.zip
peak acceleration (cm/s/s): 30.272
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{stderr}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
100\%|█████████▉| 631/632 [00:00<00:00, 2284.98it/s]
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
Spectral quantities:
       T(s)        ζ        EMACO        MPC     EMACO*MPC
      0.2969     0.04186    1.0        0.3244     0.3244
      0.2725     0.03001    1.0        0.8513     0.8513
      0.2432     0.02007    1.0        0.9816     0.9816
      0.2255     0.03043    1.0        0.8075     0.8075
      0.2231     0.0144     1.0        0.8528     0.8528
      0.1644     0.007564   1.0        0.9913     0.9913
Mean Period(s): 0.23760239670892977
Standard Dev(s): 0.041786791965444915
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}


\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}Text(0.5, 0.98, 'Painter St Bridge Transverse Mode (In: Ch17, Out: Ch9)')
\end{sphinxVerbatim}



\end{sphinxuseclass}
\end{sphinxuseclass}
}

\end{sphinxuseclass}
\begin{sphinxuseclass}{nboutput}
\begin{sphinxuseclass}{nblast}
\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\begin{sphinxuseclass}{output_area}
\begin{sphinxuseclass}{}
\noindent\sphinxincludegraphics[width=864\sphinxpxdimen,height=3401\sphinxpxdimen]{{examples_06_MIMO_History_9_36}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{nbsphinxfancyoutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{m}
\item\relax\sphinxstyleindexentry{mdof}\sphinxstyleindexpageref{library/index:\detokenize{module-mdof}}
\item\relax\sphinxstyleindexentry{mdof.markov}\sphinxstyleindexpageref{library/mdof.markov:\detokenize{module-mdof.markov}}
\item\relax\sphinxstyleindexentry{mdof.modal}\sphinxstyleindexpageref{library/mdof.modal:\detokenize{module-mdof.modal}}
\item\relax\sphinxstyleindexentry{mdof.realize}\sphinxstyleindexpageref{library/mdof.realize:\detokenize{module-mdof.realize}}
\item\relax\sphinxstyleindexentry{mdof.transform}\sphinxstyleindexpageref{library/mdof.transform:\detokenize{module-mdof.transform}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}